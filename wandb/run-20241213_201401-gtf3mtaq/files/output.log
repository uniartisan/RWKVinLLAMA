
begin training with 2 epochs




































































































Epoch 0:   0%|   | 99/32007 [05:55<29:13:20,  3.30s/it, loss=0.1615, steps/s=1.33, kt/s=21.82, trained_tokens=6.49 MT, remained_tokens=593.51 MT]
=== Function Timing Statistics ===
Step: 100
Total time: 263.03 seconds
Function breakdown:
train_step                    :   131.56s ( 50.0%) | Calls:    400 | Avg:   328.91ms
get_student_outputs           :   131.44s ( 50.0%) | Calls:    400 | Avg:   328.60ms
get_attn_loss                 :     0.03s (  0.0%) | Calls:    400 | Avg:     0.07ms







































































































Epoch 0:   1%| | 199/32007 [11:51<29:19:00,  3.32s/it, loss=0.1912, steps/s=1.31, kt/s=21.46, trained_tokens=13.04 MT, remained_tokens=586.96 MT]
=== Function Timing Statistics ===
Step: 200
Total time: 519.77 seconds
Function breakdown:
train_step                    :   259.97s ( 50.0%) | Calls:    800 | Avg:   324.96ms
get_student_outputs           :   259.74s ( 50.0%) | Calls:    800 | Avg:   324.68ms
get_attn_loss                 :     0.06s (  0.0%) | Calls:    800 | Avg:     0.07ms




































































































Epoch 0:   1%| | 299/32007 [17:46<28:53:38,  3.28s/it, loss=0.2091, steps/s=1.34, kt/s=21.91, trained_tokens=19.60 MT, remained_tokens=580.40 MT]
=== Function Timing Statistics ===
Step: 300
Total time: 777.71 seconds
Function breakdown:
train_step                    :   388.98s ( 50.0%) | Calls:   1200 | Avg:   324.15ms
get_student_outputs           :   388.64s ( 50.0%) | Calls:   1200 | Avg:   323.87ms
get_attn_loss                 :     0.09s (  0.0%) | Calls:   1200 | Avg:     0.07ms





































































































Epoch 0:   1%| | 399/32007 [23:40<28:58:23,  3.30s/it, loss=0.2028, steps/s=1.32, kt/s=21.70, trained_tokens=26.15 MT, remained_tokens=573.85 MT]
=== Function Timing Statistics ===
Step: 400
Total time: 1034.70 seconds
Function breakdown:
train_step                    :   517.51s ( 50.0%) | Calls:   1600 | Avg:   323.44ms
get_student_outputs           :   517.08s ( 50.0%) | Calls:   1600 | Avg:   323.17ms
get_attn_loss                 :     0.12s (  0.0%) | Calls:   1600 | Avg:     0.07ms






































































































Epoch 0:   2%| | 500/32007 [29:41<32:47:06,  3.75s/it, loss=0.1854, steps/s=0.64, kt/s=10.43, trained_tokens=32.77 MT, remained_tokens=567.23 MT]
=== Function Timing Statistics ===
Step: 500
Total time: 1294.40 seconds
Function breakdown:
train_step                    :   647.39s ( 50.0%) | Calls:   2000 | Avg:   323.69ms
get_student_outputs           :   646.86s ( 50.0%) | Calls:   2000 | Avg:   323.43ms
get_attn_loss                 :     0.15s (  0.0%) | Calls:   2000 | Avg:     0.07ms
================================
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000 at epoch 0 step 2000 rank 0
[2024-12-13 20:43:49,293] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_2000 is about to be saved!
[2024-12-13 20:43:49,302] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-13 20:43:49,302] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-13 20:43:49,331] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-13 20:43:49,332] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-13 20:43:51,953] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-13 20:43:51,954] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:   2%| | 600/32007 [35:38<33:40:02,  3.86s/it, loss=0.1703, steps/s=0.61, kt/s=10.03, trained_tokens=39.32 MT, remained_tokens=560.68 MT]
=== Function Timing Statistics ===
Step: 600
Total time: 1552.52 seconds
Function breakdown:
train_step                    :   776.49s ( 50.0%) | Calls:   2400 | Avg:   323.54ms
get_student_outputs           :   775.86s ( 50.0%) | Calls:   2400 | Avg:   323.27ms
get_attn_loss                 :     0.18s (  0.0%) | Calls:   2400 | Avg:     0.07ms





































































































Epoch 0:   2%| | 700/32007 [41:33<33:31:11,  3.85s/it, loss=0.1608, steps/s=0.61, kt/s=10.03, trained_tokens=45.88 MT, remained_tokens=554.12 MT]
=== Function Timing Statistics ===
Step: 700
Total time: 1809.26 seconds
Function breakdown:
train_step                    :   904.89s ( 50.0%) | Calls:   2800 | Avg:   323.17ms
get_student_outputs           :   904.16s ( 50.0%) | Calls:   2800 | Avg:   322.92ms
get_attn_loss                 :     0.21s (  0.0%) | Calls:   2800 | Avg:     0.07ms




































































































Epoch 0:   2%|  | 800/32007 [47:27<32:41:02,  3.77s/it, loss=0.1519, steps/s=0.60, kt/s=9.75, trained_tokens=52.43 MT, remained_tokens=547.57 MT]
=== Function Timing Statistics ===
Step: 800
Total time: 2067.06 seconds
Function breakdown:
train_step                    :  1033.83s ( 50.0%) | Calls:   3200 | Avg:   323.07ms
get_student_outputs           :  1033.00s ( 50.0%) | Calls:   3200 | Avg:   322.81ms
get_attn_loss                 :     0.24s (  0.0%) | Calls:   3200 | Avg:     0.08ms







































































































Epoch 0:   3%| | 899/32007 [53:16<28:45:49,  3.33s/it, loss=0.1473, steps/s=1.32, kt/s=21.57, trained_tokens=58.92 MT, remained_tokens=541.08 MT]
=== Function Timing Statistics ===
Step: 900
Total time: 2323.49 seconds
Function breakdown:
train_step                    :  1162.07s ( 50.0%) | Calls:   3600 | Avg:   322.80ms
get_student_outputs           :  1161.14s ( 50.0%) | Calls:   3600 | Avg:   322.54ms
get_attn_loss                 :     0.27s (  0.0%) | Calls:   3600 | Avg:     0.08ms






































































































Epoch 0:   3%| | 999/32007 [59:11<28:27:08,  3.30s/it, loss=0.1439, steps/s=1.33, kt/s=21.82, trained_tokens=65.47 MT, remained_tokens=534.53 MT]
=== Function Timing Statistics ===
Step: 1000
Total time: 2581.08 seconds
Function breakdown:
train_step                    :  1290.90s ( 50.0%) | Calls:   4000 | Avg:   322.73ms
get_student_outputs           :  1289.88s ( 50.0%) | Calls:   4000 | Avg:   322.47ms
get_attn_loss                 :     0.30s (  0.0%) | Calls:   4000 | Avg:     0.07ms

Epoch 0:   3%| | 1000/32007 [59:16<32:32:22,  3.78s/it, loss=0.1439, steps/s=0.62, kt/s=10.11, trained_tokens=65.54 MT, remained_tokens=534.46 MT
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000 at epoch 0 step 4000 rank 0
[2024-12-13 21:13:24,843] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_4000 is about to be saved!
[2024-12-13 21:13:24,852] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-13 21:13:24,853] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-13 21:13:24,882] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-13 21:13:24,883] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-13 21:13:27,315] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-13 21:13:27,316] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt



































































































Epoch 0:   3%| | 1099/32007 [1:05:07<28:20:40,  3.30s/it, loss=0.1406, steps/s=1.34, kt/s=21.91, trained_tokens=72.02 MT, remained_tokens=527.98
=== Function Timing Statistics ===
Step: 1100
Total time: 2836.94 seconds
Function breakdown:
train_step                    :  1418.87s ( 50.0%) | Calls:   4400 | Avg:   322.47ms
get_student_outputs           :  1417.74s ( 50.0%) | Calls:   4400 | Avg:   322.21ms
get_attn_loss                 :     0.33s (  0.0%) | Calls:   4400 | Avg:     0.07ms






































































































Epoch 0:   4%| | 1199/32007 [1:11:02<28:15:22,  3.30s/it, loss=0.1408, steps/s=1.33, kt/s=21.75, trained_tokens=78.58 MT, remained_tokens=521.42
=== Function Timing Statistics ===
Step: 1200
Total time: 3095.00 seconds
Function breakdown:
train_step                    :  1547.93s ( 50.0%) | Calls:   4800 | Avg:   322.49ms
get_student_outputs           :  1546.71s ( 50.0%) | Calls:   4800 | Avg:   322.23ms
get_attn_loss                 :     0.36s (  0.0%) | Calls:   4800 | Avg:     0.07ms







































































































Epoch 0:   4%| | 1299/32007 [1:16:56<28:16:00,  3.31s/it, loss=0.1381, steps/s=1.32, kt/s=21.56, trained_tokens=85.13 MT, remained_tokens=514.87
=== Function Timing Statistics ===
Step: 1300
Total time: 3352.10 seconds
Function breakdown:
train_step                    :  1676.52s ( 50.0%) | Calls:   5200 | Avg:   322.41ms
get_student_outputs           :  1675.20s ( 50.0%) | Calls:   5200 | Avg:   322.15ms
get_attn_loss                 :     0.39s (  0.0%) | Calls:   5200 | Avg:     0.07ms









































































































Epoch 0:   4%| | 1400/32007 [1:22:57<32:15:55,  3.80s/it, loss=0.1353, steps/s=0.61, kt/s=9.95, trained_tokens=91.75 MT, remained_tokens=508.25 M
=== Function Timing Statistics ===
Step: 1400
Total time: 3608.43 seconds
Function breakdown:
train_step                    :  1804.72s ( 50.0%) | Calls:   5600 | Avg:   322.27ms
get_student_outputs           :  1803.30s ( 50.0%) | Calls:   5600 | Avg:   322.02ms
get_attn_loss                 :     0.42s (  0.0%) | Calls:   5600 | Avg:     0.07ms





































































































Epoch 0:   5%| | 1500/32007 [1:28:51<32:02:20,  3.78s/it, loss=0.1321, steps/s=0.58, kt/s=9.54, trained_tokens=98.30 MT, remained_tokens=501.70 M
=== Function Timing Statistics ===
Step: 1500
Total time: 3864.84 seconds
Function breakdown:
train_step                    :  1932.96s ( 50.0%) | Calls:   6000 | Avg:   322.16ms
get_student_outputs           :  1931.44s ( 50.0%) | Calls:   6000 | Avg:   321.91ms
get_attn_loss                 :     0.45s (  0.0%) | Calls:   6000 | Avg:     0.08ms
================================
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000 at epoch 0 step 6000 rank 0
[2024-12-13 21:42:59,261] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_6000 is about to be saved!
[2024-12-13 21:42:59,269] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-13 21:42:59,269] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-13 21:42:59,298] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-13 21:42:59,302] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-13 21:43:01,744] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-13 21:43:01,745] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt






































































































Epoch 0:   5%| | 1600/32007 [1:34:53<32:46:51,  3.88s/it, loss=0.1300, steps/s=0.56, kt/s=9.21, trained_tokens=104.86 MT, remained_tokens=495.14
=== Function Timing Statistics ===
Step: 1600
Total time: 4125.71 seconds
Function breakdown:
train_step                    :  2063.43s ( 50.0%) | Calls:   6400 | Avg:   322.41ms
get_student_outputs           :  2061.81s ( 50.0%) | Calls:   6400 | Avg:   322.16ms
get_attn_loss                 :     0.48s (  0.0%) | Calls:   6400 | Avg:     0.08ms




































































































Epoch 0:   5%| | 1699/32007 [1:40:46<28:37:07,  3.40s/it, loss=0.1285, steps/s=1.33, kt/s=21.75, trained_tokens=111.35 MT, remained_tokens=488.65
=== Function Timing Statistics ===
Step: 1700
Total time: 4385.00 seconds
Function breakdown:
train_step                    :  2193.11s ( 50.0%) | Calls:   6800 | Avg:   322.52ms
get_student_outputs           :  2191.39s ( 50.0%) | Calls:   6800 | Avg:   322.26ms
get_attn_loss                 :     0.51s (  0.0%) | Calls:   6800 | Avg:     0.07ms












































































































Epoch 0:   6%| | 1799/32007 [1:46:45<27:40:24,  3.30s/it, loss=0.1281, steps/s=1.34, kt/s=22.01, trained_tokens=117.90 MT, remained_tokens=482.10
=== Function Timing Statistics ===
Step: 1800
Total time: 4645.53 seconds
Function breakdown:
train_step                    :  2323.41s ( 50.0%) | Calls:   7200 | Avg:   322.70ms
get_student_outputs           :  2321.58s ( 50.0%) | Calls:   7200 | Avg:   322.44ms
get_attn_loss                 :     0.54s (  0.0%) | Calls:   7200 | Avg:     0.07ms







































































































Epoch 0:   6%| | 1900/32007 [1:52:54<32:09:26,  3.85s/it, loss=0.1287, steps/s=0.61, kt/s=10.03, trained_tokens=124.52 MT, remained_tokens=475.48
=== Function Timing Statistics ===
Step: 1900
Total time: 4911.70 seconds
Function breakdown:
train_step                    :  2456.53s ( 50.0%) | Calls:   7600 | Avg:   323.23ms
get_student_outputs           :  2454.60s ( 50.0%) | Calls:   7600 | Avg:   322.97ms
get_attn_loss                 :     0.57s (  0.0%) | Calls:   7600 | Avg:     0.08ms






































































































Epoch 0:   6%| | 1999/32007 [1:58:46<27:41:56,  3.32s/it, loss=0.1268, steps/s=1.33, kt/s=21.84, trained_tokens=131.01 MT, remained_tokens=468.99
=== Function Timing Statistics ===
Step: 2000
Total time: 5170.93 seconds
Function breakdown:
train_step                    :  2586.18s ( 50.0%) | Calls:   8000 | Avg:   323.27ms
get_student_outputs           :  2584.15s ( 50.0%) | Calls:   8000 | Avg:   323.02ms
get_attn_loss                 :     0.60s (  0.0%) | Calls:   8000 | Avg:     0.07ms

Epoch 0:   6%| | 2000/32007 [1:58:51<31:27:02,  3.77s/it, loss=0.1267, steps/s=0.62, kt/s=10.09, trained_tokens=131.07 MT, remained_tokens=468.93
deleting older checkpoints epoch_0_step_2000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000 at epoch 0 step 8000 rank 0
[2024-12-13 22:13:00,739] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_8000 is about to be saved!
[2024-12-13 22:13:00,747] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-13 22:13:00,747] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-13 22:13:00,775] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-13 22:13:00,779] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-13 22:13:04,312] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-13 22:13:04,313] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt








































































































Epoch 0:   7%| | 2099/32007 [2:04:50<28:03:52,  3.38s/it, loss=0.1264, steps/s=1.34, kt/s=21.87, trained_tokens=137.56 MT, remained_tokens=462.44
=== Function Timing Statistics ===
Step: 2100
Total time: 5430.95 seconds
Function breakdown:
train_step                    :  2716.23s ( 50.0%) | Calls:   8400 | Avg:   323.36ms
get_student_outputs           :  2714.09s ( 50.0%) | Calls:   8400 | Avg:   323.11ms
get_attn_loss                 :     0.63s (  0.0%) | Calls:   8400 | Avg:     0.07ms








































































































Epoch 0:   7%| | 2200/32007 [2:10:51<32:08:55,  3.88s/it, loss=0.1269, steps/s=0.58, kt/s=9.50, trained_tokens=144.18 MT, remained_tokens=455.82
=== Function Timing Statistics ===
Step: 2200
Total time: 5689.39 seconds
Function breakdown:
train_step                    :  2845.48s ( 50.0%) | Calls:   8800 | Avg:   323.35ms
get_student_outputs           :  2843.25s ( 50.0%) | Calls:   8800 | Avg:   323.10ms
get_attn_loss                 :     0.66s (  0.0%) | Calls:   8800 | Avg:     0.07ms







































































































Epoch 0:   7%| | 2300/32007 [2:16:48<31:36:24,  3.83s/it, loss=0.1271, steps/s=0.57, kt/s=9.36, trained_tokens=150.73 MT, remained_tokens=449.27
=== Function Timing Statistics ===
Step: 2300
Total time: 5948.92 seconds
Function breakdown:
train_step                    :  2975.28s ( 50.0%) | Calls:   9200 | Avg:   323.40ms
get_student_outputs           :  2972.95s ( 50.0%) | Calls:   9200 | Avg:   323.15ms
get_attn_loss                 :     0.69s (  0.0%) | Calls:   9200 | Avg:     0.07ms








































































































Epoch 0:   7%| | 2399/32007 [2:22:42<27:29:14,  3.34s/it, loss=0.1299, steps/s=1.31, kt/s=21.52, trained_tokens=157.22 MT, remained_tokens=442.78
=== Function Timing Statistics ===
Step: 2400
Total time: 6208.75 seconds
Function breakdown:
train_step                    :  3105.23s ( 50.0%) | Calls:   9600 | Avg:   323.46ms
get_student_outputs           :  3102.80s ( 50.0%) | Calls:   9600 | Avg:   323.21ms
get_attn_loss                 :     0.72s (  0.0%) | Calls:   9600 | Avg:     0.07ms







































































































Epoch 0:   8%| | 2500/32007 [2:28:49<31:26:24,  3.84s/it, loss=0.1306, steps/s=0.57, kt/s=9.28, trained_tokens=163.84 MT, remained_tokens=436.16
=== Function Timing Statistics ===
Step: 2500
Total time: 6472.24 seconds
Function breakdown:
train_step                    :  3237.01s ( 50.0%) | Calls:  10000 | Avg:   323.70ms
get_student_outputs           :  3234.48s ( 50.0%) | Calls:  10000 | Avg:   323.45ms
get_attn_loss                 :     0.75s (  0.0%) | Calls:  10000 | Avg:     0.07ms
================================
deleting older checkpoints epoch_0_step_4000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000 at epoch 0 step 10000 rank 0
[2024-12-13 22:42:59,159] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_10000 is about to be saved!
[2024-12-13 22:42:59,167] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-13 22:42:59,168] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-13 22:42:59,196] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-13 22:42:59,199] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-13 22:43:01,723] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-13 22:43:01,724] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt






































































































Epoch 0:   8%| | 2599/32007 [2:34:43<27:00:18,  3.31s/it, loss=0.1312, steps/s=1.33, kt/s=21.84, trained_tokens=170.33 MT, remained_tokens=429.67
=== Function Timing Statistics ===
Step: 2600
Total time: 6730.30 seconds
Function breakdown:
train_step                    :  3366.08s ( 50.0%) | Calls:  10400 | Avg:   323.66ms
get_student_outputs           :  3363.44s ( 50.0%) | Calls:  10400 | Avg:   323.41ms
get_attn_loss                 :     0.78s (  0.0%) | Calls:  10400 | Avg:     0.07ms





































































































Epoch 0:   8%| | 2699/32007 [2:40:39<27:01:54,  3.32s/it, loss=0.1321, steps/s=1.30, kt/s=21.22, trained_tokens=176.88 MT, remained_tokens=423.12
=== Function Timing Statistics ===
Step: 2700
Total time: 6989.33 seconds
Function breakdown:
train_step                    :  3495.63s ( 50.0%) | Calls:  10800 | Avg:   323.67ms
get_student_outputs           :  3492.89s ( 50.0%) | Calls:  10800 | Avg:   323.42ms
get_attn_loss                 :     0.81s (  0.0%) | Calls:  10800 | Avg:     0.07ms






































































































Epoch 0:   9%| | 2799/32007 [2:46:34<27:24:37,  3.38s/it, loss=0.1311, steps/s=1.32, kt/s=21.68, trained_tokens=183.44 MT, remained_tokens=416.56
=== Function Timing Statistics ===
Step: 2800
Total time: 7247.62 seconds
Function breakdown:
train_step                    :  3624.81s ( 50.0%) | Calls:  11200 | Avg:   323.64ms
get_student_outputs           :  3621.97s ( 50.0%) | Calls:  11200 | Avg:   323.39ms
get_attn_loss                 :     0.84s (  0.0%) | Calls:  11200 | Avg:     0.07ms








































































































Epoch 0:   9%| | 2899/32007 [2:52:35<26:38:24,  3.29s/it, loss=0.1296, steps/s=1.33, kt/s=21.83, trained_tokens=189.99 MT, remained_tokens=410.01
=== Function Timing Statistics ===
Step: 2900
Total time: 7509.21 seconds
Function breakdown:
train_step                    :  3755.64s ( 50.0%) | Calls:  11600 | Avg:   323.76ms
get_student_outputs           :  3752.70s ( 50.0%) | Calls:  11600 | Avg:   323.51ms
get_attn_loss                 :     0.87s (  0.0%) | Calls:  11600 | Avg:     0.07ms






































































































Epoch 0:   9%| | 3000/32007 [2:58:40<32:49:23,  4.07s/it, loss=0.1280, steps/s=0.51, kt/s=8.36, trained_tokens=196.61 MT, remained_tokens=403.39
=== Function Timing Statistics ===
Step: 3000
Total time: 7771.70 seconds
Function breakdown:
train_step                    :  3886.92s ( 50.0%) | Calls:  12000 | Avg:   323.91ms
get_student_outputs           :  3883.88s ( 50.0%) | Calls:  12000 | Avg:   323.66ms
get_attn_loss                 :     0.90s (  0.0%) | Calls:  12000 | Avg:     0.07ms
================================
deleting older checkpoints epoch_0_step_6000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000 at epoch 0 step 12000 rank 0
[2024-12-13 23:12:49,828] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_12000 is about to be saved!
[2024-12-13 23:12:49,836] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-13 23:12:49,836] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-13 23:12:49,864] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-13 23:12:49,870] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-13 23:12:52,666] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-13 23:12:52,667] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt








































































































Epoch 0:  10%| | 3100/32007 [3:04:42<30:10:40,  3.76s/it, loss=0.1267, steps/s=0.61, kt/s=10.06, trained_tokens=203.16 MT, remained_tokens=396.84
=== Function Timing Statistics ===
Step: 3100
Total time: 8030.95 seconds
Function breakdown:
train_step                    :  4016.58s ( 50.0%) | Calls:  12400 | Avg:   323.92ms
get_student_outputs           :  4013.44s ( 50.0%) | Calls:  12400 | Avg:   323.66ms
get_attn_loss                 :     0.93s (  0.0%) | Calls:  12400 | Avg:     0.07ms






































































































Epoch 0:  10%| | 3200/32007 [3:10:42<31:10:13,  3.90s/it, loss=0.1265, steps/s=0.61, kt/s=10.00, trained_tokens=209.72 MT, remained_tokens=390.28
=== Function Timing Statistics ===
Step: 3200
Total time: 8293.83 seconds
Function breakdown:
train_step                    :  4148.06s ( 50.0%) | Calls:  12800 | Avg:   324.07ms
get_student_outputs           :  4144.81s ( 50.0%) | Calls:  12800 | Avg:   323.81ms
get_attn_loss                 :     0.96s (  0.0%) | Calls:  12800 | Avg:     0.07ms







































































































Epoch 0:  10%| | 3300/32007 [3:16:40<31:42:11,  3.98s/it, loss=0.1276, steps/s=0.51, kt/s=8.42, trained_tokens=216.27 MT, remained_tokens=383.73
=== Function Timing Statistics ===
Step: 3300
Total time: 8554.47 seconds
Function breakdown:
train_step                    :  4278.41s ( 50.0%) | Calls:  13200 | Avg:   324.12ms
get_student_outputs           :  4275.07s ( 50.0%) | Calls:  13200 | Avg:   323.87ms
get_attn_loss                 :     0.99s (  0.0%) | Calls:  13200 | Avg:     0.07ms






































































































Epoch 0:  11%| | 3399/32007 [3:22:37<26:42:12,  3.36s/it, loss=0.1272, steps/s=1.33, kt/s=21.85, trained_tokens=222.76 MT, remained_tokens=377.24
=== Function Timing Statistics ===
Step: 3400
Total time: 8816.65 seconds
Function breakdown:
train_step                    :  4409.54s ( 50.0%) | Calls:  13600 | Avg:   324.23ms
get_student_outputs           :  4406.09s ( 50.0%) | Calls:  13600 | Avg:   323.98ms
get_attn_loss                 :     1.02s (  0.0%) | Calls:  13600 | Avg:     0.07ms









































































































Epoch 0:  11%| | 3500/32007 [3:28:41<31:00:30,  3.92s/it, loss=0.1263, steps/s=0.49, kt/s=8.10, trained_tokens=229.38 MT, remained_tokens=370.62
=== Function Timing Statistics ===
Step: 3500
Total time: 9078.16 seconds
Function breakdown:
train_step                    :  4540.33s ( 50.0%) | Calls:  14000 | Avg:   324.31ms
get_student_outputs           :  4536.78s ( 50.0%) | Calls:  14000 | Avg:   324.06ms
get_attn_loss                 :     1.05s (  0.0%) | Calls:  14000 | Avg:     0.07ms
================================
deleting older checkpoints epoch_0_step_8000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000 at epoch 0 step 14000 rank 0
[2024-12-13 23:42:50,542] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_14000 is about to be saved!
[2024-12-13 23:42:50,551] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-13 23:42:50,551] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-13 23:42:50,579] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-13 23:42:50,582] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-13 23:42:53,222] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-13 23:42:53,223] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:  11%| | 3600/32007 [3:34:46<30:41:03,  3.89s/it, loss=0.1251, steps/s=0.57, kt/s=9.34, trained_tokens=235.93 MT, remained_tokens=364.07
=== Function Timing Statistics ===
Step: 3600
Total time: 9340.44 seconds
Function breakdown:
train_step                    :  4671.51s ( 50.0%) | Calls:  14400 | Avg:   324.41ms
get_student_outputs           :  4667.86s ( 50.0%) | Calls:  14400 | Avg:   324.16ms
get_attn_loss                 :     1.08s (  0.0%) | Calls:  14400 | Avg:     0.07ms





































































































Epoch 0:  12%| | 3699/32007 [3:40:41<26:07:48,  3.32s/it, loss=0.1236, steps/s=1.33, kt/s=21.78, trained_tokens=242.42 MT, remained_tokens=357.58
=== Function Timing Statistics ===
Step: 3700
Total time: 9602.69 seconds
Function breakdown:
train_step                    :  4802.67s ( 50.0%) | Calls:  14800 | Avg:   324.50ms
get_student_outputs           :  4798.91s ( 50.0%) | Calls:  14800 | Avg:   324.25ms
get_attn_loss                 :     1.11s (  0.0%) | Calls:  14800 | Avg:     0.07ms






































































































Epoch 0:  12%| | 3799/32007 [3:46:41<26:14:44,  3.35s/it, loss=0.1222, steps/s=1.34, kt/s=21.87, trained_tokens=248.97 MT, remained_tokens=351.03
=== Function Timing Statistics ===
Step: 3800
Total time: 9863.07 seconds
Function breakdown:
train_step                    :  4932.89s ( 50.0%) | Calls:  15200 | Avg:   324.53ms
get_student_outputs           :  4929.03s ( 50.0%) | Calls:  15200 | Avg:   324.28ms
get_attn_loss                 :     1.14s (  0.0%) | Calls:  15200 | Avg:     0.07ms





































































































Epoch 0:  12%| | 3900/32007 [3:52:43<30:38:58,  3.93s/it, loss=0.1215, steps/s=0.61, kt/s=10.00, trained_tokens=255.59 MT, remained_tokens=344.41
=== Function Timing Statistics ===
Step: 3900
Total time: 10122.98 seconds
Function breakdown:
train_step                    :  5062.88s ( 50.0%) | Calls:  15600 | Avg:   324.54ms
get_student_outputs           :  5058.91s ( 50.0%) | Calls:  15600 | Avg:   324.29ms
get_attn_loss                 :     1.18s (  0.0%) | Calls:  15600 | Avg:     0.08ms






































































































Epoch 0:  12%| | 4000/32007 [3:58:39<29:28:21,  3.79s/it, loss=0.1202, steps/s=0.61, kt/s=9.92, trained_tokens=262.14 MT, remained_tokens=337.86
=== Function Timing Statistics ===
Step: 4000
Total time: 10382.85 seconds
Function breakdown:
train_step                    :  5192.85s ( 50.0%) | Calls:  16000 | Avg:   324.55ms
get_student_outputs           :  5188.78s ( 50.0%) | Calls:  16000 | Avg:   324.30ms
get_attn_loss                 :     1.21s (  0.0%) | Calls:  16000 | Avg:     0.08ms
================================
deleting older checkpoints epoch_0_step_10000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000 at epoch 0 step 16000 rank 0
[2024-12-14 00:12:49,094] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_16000 is about to be saved!
[2024-12-14 00:12:49,107] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 00:12:49,107] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 00:12:49,152] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 00:12:49,154] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 00:12:52,580] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 00:12:52,581] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt




































































































Epoch 0:  13%|▏| 4100/32007 [4:04:39<29:56:43,  3.86s/it, loss=0.1187, steps/s=0.62, kt/s=10.16, trained_tokens=268.70 MT, remained_tokens=331.30
=== Function Timing Statistics ===
Step: 4100
Total time: 10641.38 seconds
Function breakdown:
train_step                    :  5322.16s ( 50.0%) | Calls:  16400 | Avg:   324.52ms
get_student_outputs           :  5317.98s ( 50.0%) | Calls:  16400 | Avg:   324.27ms
get_attn_loss                 :     1.24s (  0.0%) | Calls:  16400 | Avg:     0.08ms




































































































Epoch 0:  13%|▏| 4200/32007 [4:10:33<29:03:11,  3.76s/it, loss=0.1179, steps/s=0.62, kt/s=10.15, trained_tokens=275.25 MT, remained_tokens=324.75
=== Function Timing Statistics ===
Step: 4200
Total time: 10896.55 seconds
Function breakdown:
train_step                    :  5449.78s ( 50.0%) | Calls:  16800 | Avg:   324.39ms
get_student_outputs           :  5445.50s ( 50.0%) | Calls:  16800 | Avg:   324.14ms
get_attn_loss                 :     1.27s (  0.0%) | Calls:  16800 | Avg:     0.08ms







































































































Epoch 0:  13%|▏| 4300/32007 [4:16:30<29:17:58,  3.81s/it, loss=0.1175, steps/s=0.62, kt/s=10.14, trained_tokens=281.80 MT, remained_tokens=318.20
=== Function Timing Statistics ===
Step: 4300
Total time: 11156.74 seconds
Function breakdown:
train_step                    :  5579.91s ( 50.0%) | Calls:  17200 | Avg:   324.41ms
get_student_outputs           :  5575.53s ( 50.0%) | Calls:  17200 | Avg:   324.16ms
get_attn_loss                 :     1.30s (  0.0%) | Calls:  17200 | Avg:     0.08ms






































































































Epoch 0:  14%|▏| 4400/32007 [4:22:28<29:20:14,  3.83s/it, loss=0.1173, steps/s=0.60, kt/s=9.77, trained_tokens=288.36 MT, remained_tokens=311.64
=== Function Timing Statistics ===
Step: 4400
Total time: 11417.18 seconds
Function breakdown:
train_step                    :  5710.16s ( 50.0%) | Calls:  17600 | Avg:   324.44ms
get_student_outputs           :  5705.69s ( 50.0%) | Calls:  17600 | Avg:   324.19ms
get_attn_loss                 :     1.33s (  0.0%) | Calls:  17600 | Avg:     0.08ms

































