
begin training with 2 epochs



Epoch 0:   0%| | 3/32007 [00:16<42:38:35,  4.80s/it, loss=1032.3333, steps/s=1.08, kt/s=17.71, trained_tokens=0.20 MT, remained_tokens=769.80 MT]

































































































Epoch 0:   0%| | 99/32007 [07:12<35:57:40,  4.06s/it, loss=961.6970, steps/s=1.08, kt/s=17.69, trained_tokens=6.49 MT, remained_tokens=763.51 MT]
=== Function Timing Statistics ===
Step: 100
Total time: 331.13 seconds
Function breakdown:
train_step                    :   165.59s ( 50.0%) | Calls:    400 | Avg:   413.98ms
get_student_outputs           :   101.85s ( 30.8%) | Calls:    400 | Avg:   254.62ms
get_teacher_outputs           :    63.56s ( 19.2%) | Calls:    400 | Avg:   158.90ms
compute_kl_loss               :     0.12s (  0.0%) | Calls:    400 | Avg:     0.31ms








































































































Epoch 0:   1%| | 199/32007 [14:23<35:46:06,  4.05s/it, loss=759.4296, steps/s=1.08, kt/s=17.65, trained_tokens=13.04 MT, remained_tokens=756.96 M
=== Function Timing Statistics ===
Step: 200
Total time: 655.96 seconds
Function breakdown:
train_step                    :   328.03s ( 50.0%) | Calls:    800 | Avg:   410.03ms
get_student_outputs           :   201.89s ( 30.8%) | Calls:    800 | Avg:   252.36ms
get_teacher_outputs           :   125.85s ( 19.2%) | Calls:    800 | Avg:   157.31ms
compute_kl_loss               :     0.20s (  0.0%) | Calls:    800 | Avg:     0.25ms






































































































Epoch 0:   1%| | 299/32007 [21:34<35:40:01,  4.05s/it, loss=653.8804, steps/s=1.07, kt/s=17.53, trained_tokens=19.60 MT, remained_tokens=750.40 M
=== Function Timing Statistics ===
Step: 300
Total time: 979.65 seconds
Function breakdown:
train_step                    :   489.89s ( 50.0%) | Calls:   1200 | Avg:   408.24ms
get_student_outputs           :   301.54s ( 30.8%) | Calls:   1200 | Avg:   251.28ms
get_teacher_outputs           :   187.95s ( 19.2%) | Calls:   1200 | Avg:   156.63ms
compute_kl_loss               :     0.27s (  0.0%) | Calls:   1200 | Avg:     0.23ms





































































































Epoch 0:   1%| | 400/32007 [28:52<40:16:34,  4.59s/it, loss=587.6487, steps/s=0.52, kt/s=8.50, trained_tokens=26.21 MT, remained_tokens=743.79 MT
=== Function Timing Statistics ===
Step: 400
Total time: 1305.45 seconds
Function breakdown:
train_step                    :   652.81s ( 50.0%) | Calls:   1600 | Avg:   408.00ms
get_student_outputs           :   401.81s ( 30.8%) | Calls:   1600 | Avg:   251.13ms
get_teacher_outputs           :   250.48s ( 19.2%) | Calls:   1600 | Avg:   156.55ms
compute_kl_loss               :     0.35s (  0.0%) | Calls:   1600 | Avg:     0.22ms






































































































Epoch 0:   2%| | 499/32007 [36:00<35:35:57,  4.07s/it, loss=541.1708, steps/s=1.06, kt/s=17.38, trained_tokens=32.70 MT, remained_tokens=737.30 M
=== Function Timing Statistics ===
Step: 500
Total time: 1630.27 seconds
Function breakdown:
train_step                    :   815.24s ( 50.0%) | Calls:   2000 | Avg:   407.62ms
get_student_outputs           :   501.67s ( 30.8%) | Calls:   2000 | Avg:   250.83ms
get_teacher_outputs           :   312.94s ( 19.2%) | Calls:   2000 | Avg:   156.47ms
compute_kl_loss               :     0.42s (  0.0%) | Calls:   2000 | Avg:     0.21ms

Epoch 0:   2%| | 500/32007 [36:05<40:17:04,  4.60s/it, loss=540.8055, steps/s=0.51, kt/s=8.41, trained_tokens=32.77 MT, remained_tokens=737.23 MT
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_2000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_2000 at epoch 0 step 2000 rank 0
[2024-12-14 09:02:03,432] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_2000 is about to be saved!
[2024-12-14 09:02:03,440] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_2000/epoch_0_step_2000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 09:02:03,440] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_2000/epoch_0_step_2000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 09:02:03,472] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_2000/epoch_0_step_2000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 09:02:03,474] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 09:02:06,844] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 09:02:06,845] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:   2%| | 600/32007 [43:26<40:36:38,  4.65s/it, loss=506.5404, steps/s=0.51, kt/s=8.29, trained_tokens=39.32 MT, remained_tokens=730.68 MT
=== Function Timing Statistics ===
Step: 600
Total time: 1959.30 seconds
Function breakdown:
train_step                    :   979.77s ( 50.0%) | Calls:   2400 | Avg:   408.24ms
get_student_outputs           :   603.00s ( 30.8%) | Calls:   2400 | Avg:   251.25ms
get_teacher_outputs           :   376.03s ( 19.2%) | Calls:   2400 | Avg:   156.68ms
compute_kl_loss               :     0.50s (  0.0%) | Calls:   2400 | Avg:     0.21ms








































































































Epoch 0:   2%| | 700/32007 [50:47<40:34:33,  4.67s/it, loss=478.3293, steps/s=0.47, kt/s=7.65, trained_tokens=45.88 MT, remained_tokens=724.12 MT
=== Function Timing Statistics ===
Step: 700
Total time: 2288.79 seconds
Function breakdown:
train_step                    :  1144.53s ( 50.0%) | Calls:   2800 | Avg:   408.76ms
get_student_outputs           :   704.28s ( 30.8%) | Calls:   2800 | Avg:   251.53ms
get_teacher_outputs           :   439.40s ( 19.2%) | Calls:   2800 | Avg:   156.93ms
compute_kl_loss               :     0.58s (  0.0%) | Calls:   2800 | Avg:     0.21ms







































































































Epoch 0:   2%| | 800/32007 [58:07<39:48:37,  4.59s/it, loss=455.2347, steps/s=0.53, kt/s=8.61, trained_tokens=52.43 MT, remained_tokens=717.57 MT
=== Function Timing Statistics ===
Step: 800
Total time: 2618.96 seconds
Function breakdown:
train_step                    :  1309.64s ( 50.0%) | Calls:   3200 | Avg:   409.26ms
get_student_outputs           :   805.67s ( 30.8%) | Calls:   3200 | Avg:   251.77ms
get_teacher_outputs           :   502.99s ( 19.2%) | Calls:   3200 | Avg:   157.19ms
compute_kl_loss               :     0.66s (  0.0%) | Calls:   3200 | Avg:     0.21ms





































































































Epoch 0:   3%| | 899/32007 [1:05:14<35:08:52,  4.07s/it, loss=436.6510, steps/s=1.07, kt/s=17.46, trained_tokens=58.92 MT, remained_tokens=711.08
=== Function Timing Statistics ===
Step: 900
Total time: 2943.32 seconds
Function breakdown:
train_step                    :  1471.83s ( 50.0%) | Calls:   3600 | Avg:   408.84ms
get_student_outputs           :   905.55s ( 30.8%) | Calls:   3600 | Avg:   251.54ms
get_teacher_outputs           :   565.20s ( 19.2%) | Calls:   3600 | Avg:   157.00ms
compute_kl_loss               :     0.74s (  0.0%) | Calls:   3600 | Avg:     0.20ms





































































































Epoch 0:   3%| | 999/32007 [1:12:27<34:51:56,  4.05s/it, loss=420.5480, steps/s=1.09, kt/s=17.82, trained_tokens=65.47 MT, remained_tokens=704.53
=== Function Timing Statistics ===
Step: 1000
Total time: 3268.11 seconds
Function breakdown:
train_step                    :  1634.25s ( 50.0%) | Calls:   4000 | Avg:   408.56ms
get_student_outputs           :  1005.61s ( 30.8%) | Calls:   4000 | Avg:   251.40ms
get_teacher_outputs           :   627.44s ( 19.2%) | Calls:   4000 | Avg:   156.86ms
compute_kl_loss               :     0.81s (  0.0%) | Calls:   4000 | Avg:     0.20ms

Epoch 0:   3%| | 1000/32007 [1:12:33<39:29:16,  4.58s/it, loss=420.4125, steps/s=0.52, kt/s=8.44, trained_tokens=65.54 MT, remained_tokens=704.46
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_4000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_4000 at epoch 0 step 4000 rank 0
[2024-12-14 09:38:30,600] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_4000 is about to be saved!
[2024-12-14 09:38:30,608] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 09:38:30,608] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 09:38:30,636] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 09:38:30,637] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 09:38:34,058] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 09:38:34,058] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt







































































































Epoch 0:   3%| | 1100/32007 [1:19:59<40:51:40,  4.76s/it, loss=406.1614, steps/s=0.51, kt/s=8.37, trained_tokens=72.09 MT, remained_tokens=697.91
=== Function Timing Statistics ===
Step: 1100
Total time: 3601.54 seconds
Function breakdown:
train_step                    :  1800.98s ( 50.0%) | Calls:   4400 | Avg:   409.31ms
get_student_outputs           :  1108.61s ( 30.8%) | Calls:   4400 | Avg:   251.96ms
get_teacher_outputs           :   691.06s ( 19.2%) | Calls:   4400 | Avg:   157.06ms
compute_kl_loss               :     0.89s (  0.0%) | Calls:   4400 | Avg:     0.20ms








































































































Epoch 0:   4%| | 1200/32007 [1:27:24<39:34:46,  4.63s/it, loss=393.2975, steps/s=0.52, kt/s=8.47, trained_tokens=78.64 MT, remained_tokens=691.36
=== Function Timing Statistics ===
Step: 1200
Total time: 3934.47 seconds
Function breakdown:
train_step                    :  1967.47s ( 50.0%) | Calls:   4800 | Avg:   409.89ms
get_student_outputs           :  1210.97s ( 30.8%) | Calls:   4800 | Avg:   252.29ms
get_teacher_outputs           :   755.06s ( 19.2%) | Calls:   4800 | Avg:   157.30ms
compute_kl_loss               :     0.97s (  0.0%) | Calls:   4800 | Avg:     0.20ms




































































































Epoch 0:   4%| | 1300/32007 [1:34:48<43:23:22,  5.09s/it, loss=382.0175, steps/s=0.42, kt/s=6.93, trained_tokens=85.20 MT, remained_tokens=684.80
=== Function Timing Statistics ===
Step: 1300
Total time: 4264.19 seconds
Function breakdown:
train_step                    :  2132.35s ( 50.0%) | Calls:   5200 | Avg:   410.07ms
get_student_outputs           :  1312.53s ( 30.8%) | Calls:   5200 | Avg:   252.41ms
get_teacher_outputs           :   818.27s ( 19.2%) | Calls:   5200 | Avg:   157.36ms
compute_kl_loss               :     1.05s (  0.0%) | Calls:   5200 | Avg:     0.20ms



































































































Epoch 0:   4%| | 1399/32007 [1:42:04<34:36:07,  4.07s/it, loss=372.1296, steps/s=1.08, kt/s=17.71, trained_tokens=91.68 MT, remained_tokens=678.3
=== Function Timing Statistics ===
Step: 1400
Total time: 4594.05 seconds
Function breakdown:
train_step                    :  2297.29s ( 50.0%) | Calls:   5600 | Avg:   410.23ms
get_student_outputs           :  1414.21s ( 30.8%) | Calls:   5600 | Avg:   252.54ms
get_teacher_outputs           :   881.42s ( 19.2%) | Calls:   5600 | Avg:   157.40ms
compute_kl_loss               :     1.13s (  0.0%) | Calls:   5600 | Avg:     0.20ms








































































































Epoch 0:   5%| | 1499/32007 [1:49:25<35:03:03,  4.14s/it, loss=363.5197, steps/s=1.08, kt/s=17.67, trained_tokens=98.24 MT, remained_tokens=671.7
=== Function Timing Statistics ===
Step: 1500
Total time: 4925.43 seconds
Function breakdown:
train_step                    :  2463.00s ( 50.0%) | Calls:   6000 | Avg:   410.50ms
get_student_outputs           :  1516.32s ( 30.8%) | Calls:   6000 | Avg:   252.72ms
get_teacher_outputs           :   944.91s ( 19.2%) | Calls:   6000 | Avg:   157.48ms
compute_kl_loss               :     1.20s (  0.0%) | Calls:   6000 | Avg:     0.20ms
================================
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_6000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_6000 at epoch 0 step 6000 rank 0
[2024-12-14 10:15:29,248] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_6000 is about to be saved!
[2024-12-14 10:15:29,256] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 10:15:29,256] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 10:15:29,286] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt.

Epoch 0:   5%| | 1500/32007 [1:49:31<39:37:36,  4.68s/it, loss=363.4558, steps/s=0.50, kt/s=8.15, trained_tokens=98.30 MT, remained_tokens=671.70
[2024-12-14 10:15:32,437] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_6000/epoch_0_step_6000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 10:15:32,438] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_6000/epoch_0_step_6000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:   5%| | 1599/32007 [1:56:51<35:06:01,  4.16s/it, loss=355.1656, steps/s=1.07, kt/s=17.59, trained_tokens=104.79 MT, remained_tokens=665.
=== Function Timing Statistics ===
Step: 1600
Total time: 5256.39 seconds
Function breakdown:
train_step                    :  2628.50s ( 50.0%) | Calls:   6400 | Avg:   410.70ms
get_student_outputs           :  1618.49s ( 30.8%) | Calls:   6400 | Avg:   252.89ms
get_teacher_outputs           :  1008.13s ( 19.2%) | Calls:   6400 | Avg:   157.52ms
compute_kl_loss               :     1.27s (  0.0%) | Calls:   6400 | Avg:     0.20ms






































































































Epoch 0:   5%| | 1699/32007 [2:04:14<34:09:54,  4.06s/it, loss=347.4841, steps/s=1.08, kt/s=17.78, trained_tokens=111.35 MT, remained_tokens=658.
=== Function Timing Statistics ===
Step: 1700
Total time: 5586.68 seconds
Function breakdown:
train_step                    :  2793.66s ( 50.0%) | Calls:   6800 | Avg:   410.83ms
get_student_outputs           :  1720.49s ( 30.8%) | Calls:   6800 | Avg:   253.01ms
get_teacher_outputs           :  1071.19s ( 19.2%) | Calls:   6800 | Avg:   157.53ms
compute_kl_loss               :     1.35s (  0.0%) | Calls:   6800 | Avg:     0.20ms







































































































Epoch 0:   6%| | 1800/32007 [2:11:42<39:17:22,  4.68s/it, loss=340.5194, steps/s=0.46, kt/s=7.55, trained_tokens=117.96 MT, remained_tokens=652.0
=== Function Timing Statistics ===
Step: 1800
Total time: 5915.29 seconds
Function breakdown:
train_step                    :  2957.98s ( 50.0%) | Calls:   7200 | Avg:   410.83ms
get_student_outputs           :  1821.63s ( 30.8%) | Calls:   7200 | Avg:   253.00ms
get_teacher_outputs           :  1134.26s ( 19.2%) | Calls:   7200 | Avg:   157.54ms
compute_kl_loss               :     1.42s (  0.0%) | Calls:   7200 | Avg:     0.20ms




































































































Epoch 0:   6%| | 1899/32007 [2:19:01<35:57:10,  4.30s/it, loss=334.2192, steps/s=1.08, kt/s=17.66, trained_tokens=124.45 MT, remained_tokens=645.
=== Function Timing Statistics ===
Step: 1900
Total time: 6243.72 seconds
Function breakdown:
train_step                    :  3122.21s ( 50.0%) | Calls:   7600 | Avg:   410.82ms
get_student_outputs           :  1923.25s ( 30.8%) | Calls:   7600 | Avg:   253.06ms
get_teacher_outputs           :  1196.76s ( 19.2%) | Calls:   7600 | Avg:   157.47ms
compute_kl_loss               :     1.50s (  0.0%) | Calls:   7600 | Avg:     0.20ms








































































































Epoch 0:   6%| | 2000/32007 [2:26:34<40:29:04,  4.86s/it, loss=328.3939, steps/s=0.53, kt/s=8.70, trained_tokens=131.07 MT, remained_tokens=638.9
=== Function Timing Statistics ===
Step: 2000
Total time: 6573.08 seconds
Function breakdown:
train_step                    :  3286.91s ( 50.0%) | Calls:   8000 | Avg:   410.86ms
get_student_outputs           :  2025.49s ( 30.8%) | Calls:   8000 | Avg:   253.19ms
get_teacher_outputs           :  1259.11s ( 19.2%) | Calls:   8000 | Avg:   157.39ms
compute_kl_loss               :     1.57s (  0.0%) | Calls:   8000 | Avg:     0.20ms
================================
deleting older checkpoints epoch_0_step_2000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_8000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_8000 at epoch 0 step 8000 rank 0
[2024-12-14 10:52:33,750] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_8000 is about to be saved!
[2024-12-14 10:52:33,760] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 10:52:33,760] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 10:52:33,788] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 10:52:33,798] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 10:52:36,831] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 10:52:36,832] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:   7%| | 2099/32007 [2:34:01<33:49:04,  4.07s/it, loss=322.6878, steps/s=1.08, kt/s=17.72, trained_tokens=137.56 MT, remained_tokens=632.
=== Function Timing Statistics ===
Step: 2100
Total time: 6902.72 seconds
Function breakdown:
train_step                    :  3451.75s ( 50.0%) | Calls:   8400 | Avg:   410.92ms
get_student_outputs           :  2127.86s ( 30.8%) | Calls:   8400 | Avg:   253.32ms
get_teacher_outputs           :  1321.47s ( 19.1%) | Calls:   8400 | Avg:   157.32ms
compute_kl_loss               :     1.65s (  0.0%) | Calls:   8400 | Avg:     0.20ms






































































































Epoch 0:   7%| | 2200/32007 [2:41:36<40:35:35,  4.90s/it, loss=317.5624, steps/s=0.50, kt/s=8.20, trained_tokens=144.18 MT, remained_tokens=625.8
=== Function Timing Statistics ===
Step: 2200
Total time: 7234.69 seconds
Function breakdown:
train_step                    :  3617.75s ( 50.0%) | Calls:   8800 | Avg:   411.11ms
get_student_outputs           :  2231.04s ( 30.8%) | Calls:   8800 | Avg:   253.53ms
get_teacher_outputs           :  1384.18s ( 19.1%) | Calls:   8800 | Avg:   157.29ms
compute_kl_loss               :     1.72s (  0.0%) | Calls:   8800 | Avg:     0.20ms



































































































Epoch 0:   7%| | 2299/32007 [2:48:59<35:38:26,  4.32s/it, loss=312.5594, steps/s=1.07, kt/s=17.60, trained_tokens=150.67 MT, remained_tokens=619.
=== Function Timing Statistics ===
Step: 2300
Total time: 7565.24 seconds
Function breakdown:
train_step                    :  3783.04s ( 50.0%) | Calls:   9200 | Avg:   411.20ms
get_student_outputs           :  2333.56s ( 30.8%) | Calls:   9200 | Avg:   253.65ms
get_teacher_outputs           :  1446.84s ( 19.1%) | Calls:   9200 | Avg:   157.27ms
compute_kl_loss               :     1.80s (  0.0%) | Calls:   9200 | Avg:     0.20ms






































































































Epoch 0:   7%| | 2400/32007 [2:56:34<38:50:01,  4.72s/it, loss=307.8367, steps/s=0.51, kt/s=8.34, trained_tokens=157.29 MT, remained_tokens=612.7
=== Function Timing Statistics ===
Step: 2400
Total time: 7898.26 seconds
Function breakdown:
train_step                    :  3949.57s ( 50.0%) | Calls:   9600 | Avg:   411.41ms
get_student_outputs           :  2436.69s ( 30.9%) | Calls:   9600 | Avg:   253.82ms
get_teacher_outputs           :  1510.14s ( 19.1%) | Calls:   9600 | Avg:   157.31ms
compute_kl_loss               :     1.87s (  0.0%) | Calls:   9600 | Avg:     0.20ms




































































































Epoch 0:   8%| | 2500/32007 [3:04:00<38:18:52,  4.67s/it, loss=303.4348, steps/s=0.52, kt/s=8.44, trained_tokens=163.84 MT, remained_tokens=606.1
=== Function Timing Statistics ===
Step: 2500
Total time: 8226.53 seconds
Function breakdown:
train_step                    :  4113.72s ( 50.0%) | Calls:  10000 | Avg:   411.37ms
get_student_outputs           :  2538.69s ( 30.9%) | Calls:  10000 | Avg:   253.87ms
get_teacher_outputs           :  1572.18s ( 19.1%) | Calls:  10000 | Avg:   157.22ms
compute_kl_loss               :     1.94s (  0.0%) | Calls:  10000 | Avg:     0.19ms
================================
deleting older checkpoints epoch_0_step_4000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_10000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_10000 at epoch 0 step 10000 rank 0
[2024-12-14 11:29:59,714] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_10000 is about to be saved!
[2024-12-14 11:29:59,722] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 11:29:59,722] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 11:29:59,750] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 11:29:59,752] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 11:30:03,059] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 11:30:03,060] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt






































































































Epoch 0:   8%| | 2600/32007 [3:11:29<37:46:18,  4.62s/it, loss=299.1261, steps/s=0.52, kt/s=8.56, trained_tokens=170.39 MT, remained_tokens=599.6
=== Function Timing Statistics ===
Step: 2600
Total time: 8553.11 seconds
Function breakdown:
train_step                    :  4277.03s ( 50.0%) | Calls:  10400 | Avg:   411.25ms
get_student_outputs           :  2639.95s ( 30.9%) | Calls:  10400 | Avg:   253.84ms
get_teacher_outputs           :  1634.12s ( 19.1%) | Calls:  10400 | Avg:   157.13ms
compute_kl_loss               :     2.02s (  0.0%) | Calls:  10400 | Avg:     0.19ms




































































































Epoch 0:   8%| | 2699/32007 [3:18:49<33:17:12,  4.09s/it, loss=295.2972, steps/s=1.08, kt/s=17.77, trained_tokens=176.88 MT, remained_tokens=593.
=== Function Timing Statistics ===
Step: 2700
Total time: 8881.62 seconds
Function breakdown:
train_step                    :  4441.30s ( 50.0%) | Calls:  10800 | Avg:   411.23ms
get_student_outputs           :  2741.88s ( 30.9%) | Calls:  10800 | Avg:   253.88ms
get_teacher_outputs           :  1696.36s ( 19.1%) | Calls:  10800 | Avg:   157.07ms
compute_kl_loss               :     2.09s (  0.0%) | Calls:  10800 | Avg:     0.19ms






































































































Epoch 0:   9%| | 2800/32007 [3:26:22<37:36:38,  4.64s/it, loss=291.6254, steps/s=0.53, kt/s=8.72, trained_tokens=183.50 MT, remained_tokens=586.5
=== Function Timing Statistics ===
Step: 2800
Total time: 9211.31 seconds
Function breakdown:
train_step                    :  4606.16s ( 50.0%) | Calls:  11200 | Avg:   411.26ms
get_student_outputs           :  2843.95s ( 30.9%) | Calls:  11200 | Avg:   253.92ms
get_teacher_outputs           :  1759.04s ( 19.1%) | Calls:  11200 | Avg:   157.06ms
compute_kl_loss               :     2.16s (  0.0%) | Calls:  11200 | Avg:     0.19ms






































































































Epoch 0:   9%| | 2900/32007 [3:33:50<39:12:13,  4.85s/it, loss=288.1242, steps/s=0.39, kt/s=6.45, trained_tokens=190.05 MT, remained_tokens=579.9
=== Function Timing Statistics ===
Step: 2900
Total time: 9540.93 seconds
Function breakdown:
train_step                    :  4770.98s ( 50.0%) | Calls:  11600 | Avg:   411.29ms
get_student_outputs           :  2946.15s ( 30.9%) | Calls:  11600 | Avg:   253.98ms
get_teacher_outputs           :  1821.56s ( 19.1%) | Calls:  11600 | Avg:   157.03ms
compute_kl_loss               :     2.23s (  0.0%) | Calls:  11600 | Avg:     0.19ms






































































































Epoch 0:   9%| | 3000/32007 [3:41:20<39:28:33,  4.90s/it, loss=284.9105, steps/s=0.52, kt/s=8.48, trained_tokens=196.61 MT, remained_tokens=573.3
=== Function Timing Statistics ===
Step: 3000
Total time: 9872.28 seconds
Function breakdown:
train_step                    :  4936.67s ( 50.0%) | Calls:  12000 | Avg:   411.39ms
get_student_outputs           :  3049.19s ( 30.9%) | Calls:  12000 | Avg:   254.10ms
get_teacher_outputs           :  1884.10s ( 19.1%) | Calls:  12000 | Avg:   157.01ms
compute_kl_loss               :     2.31s (  0.0%) | Calls:  12000 | Avg:     0.19ms
================================
deleting older checkpoints epoch_0_step_6000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_12000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_12000 at epoch 0 step 12000 rank 0
[2024-12-14 12:07:19,790] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_12000 is about to be saved!
[2024-12-14 12:07:19,799] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 12:07:19,799] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 12:07:19,827] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 12:07:19,830] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 12:07:23,599] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 12:07:23,600] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt




































































































Epoch 0:  10%| | 3099/32007 [3:48:44<34:02:03,  4.24s/it, loss=281.7396, steps/s=1.09, kt/s=17.84, trained_tokens=203.10 MT, remained_tokens=566.
=== Function Timing Statistics ===
Step: 3100
Total time: 10200.24 seconds
Function breakdown:
train_step                    :  5100.67s ( 50.0%) | Calls:  12400 | Avg:   411.34ms
get_student_outputs           :  3150.89s ( 30.9%) | Calls:  12400 | Avg:   254.10ms
get_teacher_outputs           :  1946.30s ( 19.1%) | Calls:  12400 | Avg:   156.96ms
compute_kl_loss               :     2.38s (  0.0%) | Calls:  12400 | Avg:     0.19ms





































































































Epoch 0:  10%| | 3199/32007 [3:56:13<33:30:51,  4.19s/it, loss=278.7267, steps/s=1.07, kt/s=17.61, trained_tokens=209.65 MT, remained_tokens=560.
=== Function Timing Statistics ===
Step: 3200
Total time: 10530.63 seconds
Function breakdown:
train_step                    :  5265.89s ( 50.0%) | Calls:  12800 | Avg:   411.40ms
get_student_outputs           :  3253.48s ( 30.9%) | Calls:  12800 | Avg:   254.18ms
get_teacher_outputs           :  2008.80s ( 19.1%) | Calls:  12800 | Avg:   156.94ms
compute_kl_loss               :     2.46s (  0.0%) | Calls:  12800 | Avg:     0.19ms









































































































Epoch 0:  10%| | 3300/32007 [4:03:46<37:26:45,  4.70s/it, loss=275.8509, steps/s=0.51, kt/s=8.32, trained_tokens=216.27 MT, remained_tokens=553.7
=== Function Timing Statistics ===
Step: 3300
Total time: 10860.93 seconds
Function breakdown:
train_step                    :  5431.06s ( 50.0%) | Calls:  13200 | Avg:   411.44ms
get_student_outputs           :  3356.04s ( 30.9%) | Calls:  13200 | Avg:   254.25ms
get_teacher_outputs           :  2071.31s ( 19.1%) | Calls:  13200 | Avg:   156.92ms
compute_kl_loss               :     2.53s (  0.0%) | Calls:  13200 | Avg:     0.19ms





































































































Epoch 0:  11%| | 3400/32007 [4:11:13<37:34:07,  4.73s/it, loss=273.0935, steps/s=0.52, kt/s=8.49, trained_tokens=222.82 MT, remained_tokens=547.1
=== Function Timing Statistics ===
Step: 3400
Total time: 11190.25 seconds
Function breakdown:
train_step                    :  5595.73s ( 50.0%) | Calls:  13600 | Avg:   411.45ms
get_student_outputs           :  3457.96s ( 30.9%) | Calls:  13600 | Avg:   254.26ms
get_teacher_outputs           :  2133.94s ( 19.1%) | Calls:  13600 | Avg:   156.91ms
compute_kl_loss               :     2.61s (  0.0%) | Calls:  13600 | Avg:     0.19ms




































































































Epoch 0:  11%| | 3499/32007 [4:18:36<32:51:47,  4.15s/it, loss=270.4030, steps/s=1.08, kt/s=17.68, trained_tokens=229.31 MT, remained_tokens=540.
=== Function Timing Statistics ===
Step: 3500
Total time: 11520.06 seconds
Function breakdown:
train_step                    :  5760.66s ( 50.0%) | Calls:  14000 | Avg:   411.48ms
get_student_outputs           :  3560.24s ( 30.9%) | Calls:  14000 | Avg:   254.30ms
get_teacher_outputs           :  2196.47s ( 19.1%) | Calls:  14000 | Avg:   156.89ms
compute_kl_loss               :     2.69s (  0.0%) | Calls:  14000 | Avg:     0.19ms

Epoch 0:  11%| | 3500/32007 [4:18:43<39:29:10,  4.99s/it, loss=270.3711, steps/s=0.42, kt/s=6.96, trained_tokens=229.38 MT, remained_tokens=540.6
deleting older checkpoints epoch_0_step_8000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_14000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_14000 at epoch 0 step 14000 rank 0
[2024-12-14 12:44:42,841] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_14000 is about to be saved!
[2024-12-14 12:44:42,849] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 12:44:42,850] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 12:44:42,878] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 12:44:42,880] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 12:44:46,298] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 12:44:46,299] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:  11%| | 3599/32007 [4:26:08<34:09:54,  4.33s/it, loss=267.8179, steps/s=1.08, kt/s=17.72, trained_tokens=235.86 MT, remained_tokens=534.
=== Function Timing Statistics ===
Step: 3600
Total time: 11849.13 seconds
Function breakdown:
train_step                    :  5925.21s ( 50.0%) | Calls:  14400 | Avg:   411.47ms
get_student_outputs           :  3662.27s ( 30.9%) | Calls:  14400 | Avg:   254.32ms
get_teacher_outputs           :  2258.89s ( 19.1%) | Calls:  14400 | Avg:   156.87ms
compute_kl_loss               :     2.76s (  0.0%) | Calls:  14400 | Avg:     0.19ms




































































































Epoch 0:  12%| | 3699/32007 [4:33:35<33:15:16,  4.23s/it, loss=265.2524, steps/s=1.08, kt/s=17.63, trained_tokens=242.42 MT, remained_tokens=527.
=== Function Timing Statistics ===
Step: 3700
Total time: 12179.12 seconds
Function breakdown:
train_step                    :  6090.22s ( 50.0%) | Calls:  14800 | Avg:   411.50ms
get_student_outputs           :  3764.57s ( 30.9%) | Calls:  14800 | Avg:   254.36ms
get_teacher_outputs           :  2321.49s ( 19.1%) | Calls:  14800 | Avg:   156.86ms
compute_kl_loss               :     2.84s (  0.0%) | Calls:  14800 | Avg:     0.19ms




































































































Epoch 0:  12%| | 3799/32007 [4:41:03<32:41:35,  4.17s/it, loss=262.8830, steps/s=1.09, kt/s=17.85, trained_tokens=248.97 MT, remained_tokens=521.
=== Function Timing Statistics ===
Step: 3800
Total time: 12508.66 seconds
Function breakdown:
train_step                    :  6255.01s ( 50.0%) | Calls:  15200 | Avg:   411.51ms
get_student_outputs           :  3866.73s ( 30.9%) | Calls:  15200 | Avg:   254.39ms
get_teacher_outputs           :  2384.00s ( 19.1%) | Calls:  15200 | Avg:   156.84ms
compute_kl_loss               :     2.91s (  0.0%) | Calls:  15200 | Avg:     0.19ms





































































































Epoch 0:  12%| | 3900/32007 [4:48:35<36:06:16,  4.62s/it, loss=260.6091, steps/s=0.53, kt/s=8.61, trained_tokens=255.59 MT, remained_tokens=514.4
=== Function Timing Statistics ===
Step: 3900
Total time: 12837.42 seconds
Function breakdown:
train_step                    :  6419.41s ( 50.0%) | Calls:  15600 | Avg:   411.50ms
get_student_outputs           :  3968.70s ( 30.9%) | Calls:  15600 | Avg:   254.40ms
get_teacher_outputs           :  2446.32s ( 19.1%) | Calls:  15600 | Avg:   156.82ms
compute_kl_loss               :     2.99s (  0.0%) | Calls:  15600 | Avg:     0.19ms



































































































Epoch 0:  12%| | 3999/32007 [4:55:55<32:00:12,  4.11s/it, loss=258.4160, steps/s=1.08, kt/s=17.76, trained_tokens=262.08 MT, remained_tokens=507.
=== Function Timing Statistics ===
Step: 4000
Total time: 13165.47 seconds
Function breakdown:
train_step                    :  6583.45s ( 50.0%) | Calls:  16000 | Avg:   411.47ms
get_student_outputs           :  4070.13s ( 30.9%) | Calls:  16000 | Avg:   254.38ms
get_teacher_outputs           :  2508.83s ( 19.1%) | Calls:  16000 | Avg:   156.80ms
compute_kl_loss               :     3.06s (  0.0%) | Calls:  16000 | Avg:     0.19ms

Epoch 0:  12%| | 4000/32007 [4:56:01<36:03:14,  4.63s/it, loss=258.3937, steps/s=0.52, kt/s=8.44, trained_tokens=262.14 MT, remained_tokens=507.8
deleting older checkpoints epoch_0_step_10000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_16000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_16000 at epoch 0 step 16000 rank 0
[2024-12-14 13:22:00,623] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_16000 is about to be saved!
[2024-12-14 13:22:00,631] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 13:22:00,631] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 13:22:00,659] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 13:22:00,662] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 13:22:03,689] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 13:22:03,689] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt




































































































Epoch 0:  13%|▏| 4100/32007 [5:03:32<37:31:44,  4.84s/it, loss=256.2930, steps/s=0.39, kt/s=6.42, trained_tokens=268.70 MT, remained_tokens=501.3
=== Function Timing Statistics ===
Step: 4100
Total time: 13495.16 seconds
Function breakdown:
train_step                    :  6748.31s ( 50.0%) | Calls:  16400 | Avg:   411.48ms
get_student_outputs           :  4172.35s ( 30.9%) | Calls:  16400 | Avg:   254.41ms
get_teacher_outputs           :  2571.36s ( 19.1%) | Calls:  16400 | Avg:   156.79ms
compute_kl_loss               :     3.13s (  0.0%) | Calls:  16400 | Avg:     0.19ms




































































































Epoch 0:  13%|▏| 4200/32007 [5:11:00<38:06:24,  4.93s/it, loss=254.2608, steps/s=0.51, kt/s=8.43, trained_tokens=275.25 MT, remained_tokens=494.7
=== Function Timing Statistics ===
Step: 4200
Total time: 13824.29 seconds
Function breakdown:
train_step                    :  6912.90s ( 50.0%) | Calls:  16800 | Avg:   411.48ms
get_student_outputs           :  4274.42s ( 30.9%) | Calls:  16800 | Avg:   254.43ms
get_teacher_outputs           :  2633.77s ( 19.1%) | Calls:  16800 | Avg:   156.77ms
compute_kl_loss               :     3.21s (  0.0%) | Calls:  16800 | Avg:     0.19ms



































































































Epoch 0:  13%|▏| 4299/32007 [5:18:21<33:40:40,  4.38s/it, loss=252.2809, steps/s=1.09, kt/s=17.80, trained_tokens=281.74 MT, remained_tokens=488.
=== Function Timing Statistics ===
Step: 4300
Total time: 14154.69 seconds
Function breakdown:
train_step                    :  7078.11s ( 50.0%) | Calls:  17200 | Avg:   411.52ms
get_student_outputs           :  4376.92s ( 30.9%) | Calls:  17200 | Avg:   254.47ms
get_teacher_outputs           :  2696.36s ( 19.0%) | Calls:  17200 | Avg:   156.77ms
compute_kl_loss               :     3.29s (  0.0%) | Calls:  17200 | Avg:     0.19ms




































































































Epoch 0:  14%|▏| 4399/32007 [5:25:49<32:50:08,  4.28s/it, loss=250.3277, steps/s=1.08, kt/s=17.66, trained_tokens=288.29 MT, remained_tokens=481.
=== Function Timing Statistics ===
Step: 4400
Total time: 14485.90 seconds
Function breakdown:
train_step                    :  7243.74s ( 50.0%) | Calls:  17600 | Avg:   411.58ms
get_student_outputs           :  4479.64s ( 30.9%) | Calls:  17600 | Avg:   254.53ms
get_teacher_outputs           :  2759.16s ( 19.0%) | Calls:  17600 | Avg:   156.77ms
compute_kl_loss               :     3.36s (  0.0%) | Calls:  17600 | Avg:     0.19ms





































































































Epoch 0:  14%|▏| 4500/32007 [5:33:23<36:00:02,  4.71s/it, loss=248.4252, steps/s=0.52, kt/s=8.53, trained_tokens=294.91 MT, remained_tokens=475.0
=== Function Timing Statistics ===
Step: 4500
Total time: 14815.21 seconds
Function breakdown:
train_step                    :  7408.42s ( 50.0%) | Calls:  18000 | Avg:   411.58ms
get_student_outputs           :  4581.83s ( 30.9%) | Calls:  18000 | Avg:   254.55ms
get_teacher_outputs           :  2821.53s ( 19.0%) | Calls:  18000 | Avg:   156.75ms
compute_kl_loss               :     3.44s (  0.0%) | Calls:  18000 | Avg:     0.19ms
================================
deleting older checkpoints epoch_0_step_12000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_18000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_18000 at epoch 0 step 18000 rank 0
[2024-12-14 13:59:22,435] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_18000 is about to be saved!
[2024-12-14 13:59:22,446] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_18000/epoch_0_step_18000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 13:59:22,446] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_18000/epoch_0_step_18000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 13:59:22,478] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_18000/epoch_0_step_18000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 13:59:22,479] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_18000/epoch_0_step_18000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 13:59:25,650] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_18000/epoch_0_step_18000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 13:59:25,651] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_18000/epoch_0_step_18000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:  14%|▏| 4600/32007 [5:40:56<35:34:40,  4.67s/it, loss=246.6036, steps/s=0.52, kt/s=8.49, trained_tokens=301.47 MT, remained_tokens=468.5
=== Function Timing Statistics ===
Step: 4600
Total time: 15144.70 seconds
Function breakdown:
train_step                    :  7573.18s ( 50.0%) | Calls:  18400 | Avg:   411.59ms
get_student_outputs           :  4684.04s ( 30.9%) | Calls:  18400 | Avg:   254.57ms
get_teacher_outputs           :  2883.97s ( 19.0%) | Calls:  18400 | Avg:   156.74ms
compute_kl_loss               :     3.51s (  0.0%) | Calls:  18400 | Avg:     0.19ms




































































































Epoch 0:  15%|▏| 4700/32007 [5:48:25<38:00:49,  5.01s/it, loss=244.8076, steps/s=0.39, kt/s=6.33, trained_tokens=308.02 MT, remained_tokens=461.9
=== Function Timing Statistics ===
Step: 4700
Total time: 15475.56 seconds
Function breakdown:
train_step                    :  7738.62s ( 50.0%) | Calls:  18800 | Avg:   411.63ms
get_student_outputs           :  4786.60s ( 30.9%) | Calls:  18800 | Avg:   254.61ms
get_teacher_outputs           :  2946.75s ( 19.0%) | Calls:  18800 | Avg:   156.74ms
compute_kl_loss               :     3.58s (  0.0%) | Calls:  18800 | Avg:     0.19ms




































































































Epoch 0:  15%|▏| 4800/32007 [5:55:55<37:45:58,  5.00s/it, loss=243.0384, steps/s=0.47, kt/s=7.74, trained_tokens=314.57 MT, remained_tokens=455.4
=== Function Timing Statistics ===
Step: 4800
Total time: 15805.48 seconds
Function breakdown:
train_step                    :  7903.60s ( 50.0%) | Calls:  19200 | Avg:   411.65ms
get_student_outputs           :  4888.83s ( 30.9%) | Calls:  19200 | Avg:   254.63ms
get_teacher_outputs           :  3009.39s ( 19.0%) | Calls:  19200 | Avg:   156.74ms
compute_kl_loss               :     3.66s (  0.0%) | Calls:  19200 | Avg:     0.19ms




































































































Epoch 0:  15%|▏| 4900/32007 [6:03:24<36:26:46,  4.84s/it, loss=241.3392, steps/s=0.50, kt/s=8.16, trained_tokens=321.13 MT, remained_tokens=448.8
=== Function Timing Statistics ===
Step: 4900
Total time: 16135.01 seconds
Function breakdown:
train_step                    :  8068.38s ( 50.0%) | Calls:  19600 | Avg:   411.65ms
get_student_outputs           :  4991.30s ( 30.9%) | Calls:  19600 | Avg:   254.66ms
get_teacher_outputs           :  3071.59s ( 19.0%) | Calls:  19600 | Avg:   156.71ms
compute_kl_loss               :     3.73s (  0.0%) | Calls:  19600 | Avg:     0.19ms



































































































Epoch 0:  16%|▏| 4999/32007 [6:10:46<31:36:30,  4.21s/it, loss=239.6586, steps/s=1.09, kt/s=17.88, trained_tokens=327.61 MT, remained_tokens=442.
=== Function Timing Statistics ===
Step: 5000
Total time: 16464.60 seconds
Function breakdown:
train_step                    :  8233.20s ( 50.0%) | Calls:  20000 | Avg:   411.66ms
get_student_outputs           :  5093.60s ( 30.9%) | Calls:  20000 | Avg:   254.68ms
get_teacher_outputs           :  3133.99s ( 19.0%) | Calls:  20000 | Avg:   156.70ms
compute_kl_loss               :     3.81s (  0.0%) | Calls:  20000 | Avg:     0.19ms
================================

Epoch 0:  16%|▏| 5000/32007 [6:10:52<35:32:13,  4.74s/it, loss=239.6427, steps/s=0.49, kt/s=8.03, trained_tokens=327.68 MT, remained_tokens=442.3
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_20000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_20000 at epoch 0 step 20000 rank 0
[2024-12-14 14:36:51,855] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_20000 is about to be saved!
[2024-12-14 14:36:51,863] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_20000/epoch_0_step_20000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 14:36:51,863] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_20000/epoch_0_step_20000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 14:36:52,295] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_20000/epoch_0_step_20000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 14:36:52,296] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_20000/epoch_0_step_20000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 14:36:56,029] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_20000/epoch_0_step_20000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 14:36:56,030] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_20000/epoch_0_step_20000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt



































































































Epoch 0:  16%|▏| 5099/32007 [6:18:18<30:52:51,  4.13s/it, loss=238.1102, steps/s=1.09, kt/s=17.88, trained_tokens=334.17 MT, remained_tokens=435.
=== Function Timing Statistics ===
Step: 5100
Total time: 16792.57 seconds
Function breakdown:
train_step                    :  8397.20s ( 50.0%) | Calls:  20400 | Avg:   411.63ms
get_student_outputs           :  5194.96s ( 30.9%) | Calls:  20400 | Avg:   254.65ms
get_teacher_outputs           :  3196.53s ( 19.0%) | Calls:  20400 | Avg:   156.69ms
compute_kl_loss               :     3.88s (  0.0%) | Calls:  20400 | Avg:     0.19ms




































































































Epoch 0:  16%|▏| 5199/32007 [6:25:47<31:06:29,  4.18s/it, loss=236.5391, steps/s=1.08, kt/s=17.74, trained_tokens=340.72 MT, remained_tokens=429.
=== Function Timing Statistics ===
Step: 5200
Total time: 17122.78 seconds
Function breakdown:
train_step                    :  8562.32s ( 50.0%) | Calls:  20800 | Avg:   411.65ms
get_student_outputs           :  5297.33s ( 30.9%) | Calls:  20800 | Avg:   254.68ms
get_teacher_outputs           :  3259.16s ( 19.0%) | Calls:  20800 | Avg:   156.69ms
compute_kl_loss               :     3.97s (  0.0%) | Calls:  20800 | Avg:     0.19ms





































































































Epoch 0:  17%|▏| 5300/32007 [6:33:23<37:02:58,  4.99s/it, loss=234.9270, steps/s=0.40, kt/s=6.58, trained_tokens=347.34 MT, remained_tokens=422.6
=== Function Timing Statistics ===
Step: 5300
Total time: 17453.23 seconds
Function breakdown:
train_step                    :  8727.56s ( 50.0%) | Calls:  21200 | Avg:   411.68ms
get_student_outputs           :  5399.80s ( 30.9%) | Calls:  21200 | Avg:   254.71ms
get_teacher_outputs           :  3321.82s ( 19.0%) | Calls:  21200 | Avg:   156.69ms
compute_kl_loss               :     4.04s (  0.0%) | Calls:  21200 | Avg:     0.19ms




































































































Epoch 0:  17%|▏| 5400/32007 [6:40:53<36:15:39,  4.91s/it, loss=233.5037, steps/s=0.51, kt/s=8.42, trained_tokens=353.89 MT, remained_tokens=416.1
=== Function Timing Statistics ===
Step: 5400
Total time: 17783.71 seconds
Function breakdown:
train_step                    :  8892.82s ( 50.0%) | Calls:  21600 | Avg:   411.70ms
get_student_outputs           :  5502.50s ( 30.9%) | Calls:  21600 | Avg:   254.75ms
get_teacher_outputs           :  3384.27s ( 19.0%) | Calls:  21600 | Avg:   156.68ms
compute_kl_loss               :     4.12s (  0.0%) | Calls:  21600 | Avg:     0.19ms



































































































Epoch 0:  17%|▏| 5499/32007 [6:48:15<31:11:21,  4.24s/it, loss=232.0853, steps/s=1.07, kt/s=17.48, trained_tokens=360.38 MT, remained_tokens=409.
=== Function Timing Statistics ===
Step: 5500
Total time: 18112.73 seconds
Function breakdown:
train_step                    :  9057.35s ( 50.0%) | Calls:  22000 | Avg:   411.70ms
get_student_outputs           :  5604.41s ( 30.9%) | Calls:  22000 | Avg:   254.75ms
get_teacher_outputs           :  3446.77s ( 19.0%) | Calls:  22000 | Avg:   156.67ms
compute_kl_loss               :     4.20s (  0.0%) | Calls:  22000 | Avg:     0.19ms

Epoch 0:  17%|▏| 5500/32007 [6:48:21<34:52:49,  4.74s/it, loss=232.0697, steps/s=0.51, kt/s=8.32, trained_tokens=360.45 MT, remained_tokens=409.5
deleting older checkpoints epoch_0_step_16000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_22000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_22000 at epoch 0 step 22000 rank 0
[2024-12-14 15:14:20,811] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_22000 is about to be saved!
[2024-12-14 15:14:20,820] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_22000/epoch_0_step_22000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 15:14:20,820] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_22000/epoch_0_step_22000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 15:14:20,849] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_22000/epoch_0_step_22000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 15:14:20,860] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_22000/epoch_0_step_22000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 15:14:23,905] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_22000/epoch_0_step_22000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 15:14:23,906] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage2/epoch_0_step_22000/epoch_0_step_22000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt



































































































Epoch 0:  17%|▏| 5599/32007 [6:55:50<30:18:58,  4.13s/it, loss=230.6836, steps/s=1.07, kt/s=17.61, trained_tokens=366.94 MT, remained_tokens=403.
=== Function Timing Statistics ===
Step: 5600
Total time: 18441.70 seconds
Function breakdown:
train_step                    :  9221.85s ( 50.0%) | Calls:  22400 | Avg:   411.69ms
get_student_outputs           :  5706.52s ( 30.9%) | Calls:  22400 | Avg:   254.76ms
get_teacher_outputs           :  3509.05s ( 19.0%) | Calls:  22400 | Avg:   156.65ms
compute_kl_loss               :     4.27s (  0.0%) | Calls:  22400 | Avg:     0.19ms




































































































Epoch 0:  18%|▏| 5699/32007 [7:03:19<30:11:00,  4.13s/it, loss=229.3187, steps/s=1.09, kt/s=17.83, trained_tokens=373.49 MT, remained_tokens=396.
=== Function Timing Statistics ===
Step: 5700
Total time: 18771.48 seconds
Function breakdown:
train_step                    :  9386.76s ( 50.0%) | Calls:  22800 | Avg:   411.70ms
get_student_outputs           :  5808.69s ( 30.9%) | Calls:  22800 | Avg:   254.77ms
get_teacher_outputs           :  3571.68s ( 19.0%) | Calls:  22800 | Avg:   156.65ms
compute_kl_loss               :     4.35s (  0.0%) | Calls:  22800 | Avg:     0.19ms




































































































Epoch 0:  18%|▏| 5799/32007 [7:10:50<30:16:07,  4.16s/it, loss=227.9764, steps/s=1.08, kt/s=17.70, trained_tokens=380.04 MT, remained_tokens=389.
=== Function Timing Statistics ===
Step: 5800
Total time: 19101.44 seconds
Function breakdown:
train_step                    :  9551.76s ( 50.0%) | Calls:  23200 | Avg:   411.71ms
get_student_outputs           :  5911.15s ( 30.9%) | Calls:  23200 | Avg:   254.79ms
get_teacher_outputs           :  3634.11s ( 19.0%) | Calls:  23200 | Avg:   156.64ms
compute_kl_loss               :     4.42s (  0.0%) | Calls:  23200 | Avg:     0.19ms
















