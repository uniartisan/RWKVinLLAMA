


























Epoch 0:   0%|                                              | 25/841778 [01:01<533:30:54,  2.28s/it, loss=640.9111, steps/s=1.77, kt/s=29.06]
[2024-10-26 14:58:25,921] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_100 is about to be saved!
[2024-10-26 14:58:25,932] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-10-26 14:58:25,932] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-10-26 14:58:26,383] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-10-26 14:58:26,385] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-10-26 14:58:26,396] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-10-26 14:58:26,396] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-10-26 14:58:26,414] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint epoch_0_step_100 is ready now!

























Epoch 0:   0%|                                              | 50/841778 [01:59<538:26:04,  2.30s/it, loss=823.1017, steps/s=1.77, kt/s=28.93]
[2024-10-26 14:59:23,727] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_200 is about to be saved!
[2024-10-26 14:59:23,738] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-10-26 14:59:23,738] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-10-26 14:59:24,174] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-10-26 14:59:24,184] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-10-26 14:59:24,196] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-10-26 14:59:24,196] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-10-26 14:59:24,215] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint epoch_0_step_200 is ready now!

























Epoch 0:   0%|                                              | 75/841778 [02:56<529:08:53,  2.26s/it, loss=620.4585, steps/s=1.78, kt/s=29.17]
[2024-10-26 15:00:20,989] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_300 is about to be saved!
[2024-10-26 15:00:21,004] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_300/epoch_0_step_300/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-10-26 15:00:21,004] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_300/epoch_0_step_300/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-10-26 15:00:21,450] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_300/epoch_0_step_300/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-10-26 15:00:21,452] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_300/epoch_0_step_300/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-10-26 15:00:21,463] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_300/epoch_0_step_300/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-10-26 15:00:21,464] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_300/epoch_0_step_300/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-10-26 15:00:21,483] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint epoch_0_step_300 is ready now!
























Epoch 0:   0%|                                             | 100/841778 [03:54<534:04:50,  2.28s/it, loss=410.9209, steps/s=1.65, kt/s=26.96]Traceback (most recent call last):
  File "/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py", line 441, in <module>
    last_log_time, pbar = on_train_batch_end(
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py", line 208, in on_train_batch_end
    os.remove(os.path.join(args.output_dir, checkpoints[0]))
IsADirectoryError: [Errno 21] Is a directory: '/home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py", line 441, in <module>
[rank0]:     last_log_time, pbar = on_train_batch_end(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py", line 208, in on_train_batch_end
[rank0]:     os.remove(os.path.join(args.output_dir, checkpoints[0]))
[rank0]:     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: IsADirectoryError: [Errno 21] Is a directory: '/home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100'
deleting older checkpoints epoch_0_step_100