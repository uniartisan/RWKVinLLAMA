

























Epoch 0:   0%|                                              | 25/841778 [01:01<535:38:55,  2.29s/it, loss=550.3698, steps/s=1.77, kt/s=28.94]
[2024-10-26 14:45:26,908] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_100 is about to be saved!
[2024-10-26 14:45:26,919] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-10-26 14:45:26,920] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-10-26 14:45:27,372] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-10-26 14:45:27,378] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-10-26 14:45:27,388] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-10-26 14:45:27,388] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_100/epoch_0_step_100/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-10-26 14:45:27,409] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint epoch_0_step_100 is ready now!

























Epoch 0:   0%|                                              | 50/841778 [01:59<538:05:28,  2.30s/it, loss=792.5952, steps/s=1.78, kt/s=29.14]
[2024-10-26 14:46:24,907] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_200 is about to be saved!
[2024-10-26 14:46:24,918] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-10-26 14:46:24,918] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-10-26 14:46:25,357] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-10-26 14:46:25,362] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-10-26 14:46:25,374] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-10-26 14:46:25,374] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/tmp/distill_qwen05b_1/epoch_0_step_200/epoch_0_step_200/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-10-26 14:46:25,394] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint epoch_0_step_200 is ready now!
























Epoch 0:   0%|                                              | 74/841778 [02:54<527:52:42,  2.26s/it, loss=550.0912, steps/s=1.77, kt/s=29.05]
Epoch 0:   0%|                                              | 75/841778 [02:56<527:43:37,  2.26s/it, loss=474.6044, steps/s=1.77, kt/s=28.92]Traceback (most recent call last):
  File "/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py", line 438, in <module>
    last_log_time, pbar = on_train_batch_end(
                          ^^^^^^^^^^^^^^^^^^^
  File "/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py", line 205, in on_train_batch_end
    os.remove(os.path.join(args.output_dir, checkpoints[0]))
FileNotFoundError: [Errno 2] No such file or directory: '/home/yueyulin/tmp/distill_qwen05b_1/train_log.txt'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py", line 438, in <module>
[rank0]:     last_log_time, pbar = on_train_batch_end(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py", line 205, in on_train_batch_end
[rank0]:     os.remove(os.path.join(args.output_dir, checkpoints[0]))
[rank0]:     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: FileNotFoundError: [Errno 2] No such file or directory: '/home/yueyulin/tmp/distill_qwen05b_1/train_log.txt'