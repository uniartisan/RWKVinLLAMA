
begin training with 2 epochs



Epoch 0:   0%|    | 3/16003 [00:12<16:30:50,  3.72s/it, loss=0.1598, steps/s=1.45, kt/s=47.42, trained_tokens=0.39 MT, remained_tokens=769.61 MT]

































































































Epoch 0:   1%|  | 99/16003 [05:07<13:15:30,  3.00s/it, loss=0.1570, steps/s=1.43, kt/s=46.74, trained_tokens=12.98 MT, remained_tokens=757.02 MT]
=== Function Timing Statistics ===
Step: 100
Total time: 267.91 seconds
Function breakdown:
train_step                    :   133.99s ( 50.0%) | Calls:    400 | Avg:   334.97ms
get_student_outputs           :   133.89s ( 50.0%) | Calls:    400 | Avg:   334.73ms
get_attn_loss                 :     0.03s (  0.0%) | Calls:    400 | Avg:     0.08ms







































































































Epoch 0:   1%| | 199/16003 [10:15<12:57:21,  2.95s/it, loss=0.1490, steps/s=1.45, kt/s=47.35, trained_tokens=26.08 MT, remained_tokens=743.92 MT]
=== Function Timing Statistics ===
Step: 200
Total time: 530.00 seconds
Function breakdown:
train_step                    :   265.05s ( 50.0%) | Calls:    800 | Avg:   331.32ms
get_student_outputs           :   264.89s ( 50.0%) | Calls:    800 | Avg:   331.11ms
get_attn_loss                 :     0.06s (  0.0%) | Calls:    800 | Avg:     0.08ms





































































































Epoch 0:   2%| | 299/16003 [15:21<12:49:30,  2.94s/it, loss=0.1409, steps/s=1.43, kt/s=46.80, trained_tokens=39.19 MT, remained_tokens=730.81 MT]
=== Function Timing Statistics ===
Step: 300
Total time: 791.24 seconds
Function breakdown:
train_step                    :   395.69s ( 50.0%) | Calls:   1200 | Avg:   329.74ms
get_student_outputs           :   395.45s ( 50.0%) | Calls:   1200 | Avg:   329.54ms
get_attn_loss                 :     0.09s (  0.0%) | Calls:   1200 | Avg:     0.08ms





































































































Epoch 0:   2%| | 399/16003 [20:28<12:55:04,  2.98s/it, loss=0.1341, steps/s=1.47, kt/s=48.12, trained_tokens=52.30 MT, remained_tokens=717.70 MT]
=== Function Timing Statistics ===
Step: 400
Total time: 1052.61 seconds
Function breakdown:
train_step                    :   526.40s ( 50.0%) | Calls:   1600 | Avg:   329.00ms
get_student_outputs           :   526.08s ( 50.0%) | Calls:   1600 | Avg:   328.80ms
get_attn_loss                 :     0.12s (  0.0%) | Calls:   1600 | Avg:     0.08ms






































































































Epoch 0:   3%| | 499/16003 [25:35<12:42:58,  2.95s/it, loss=0.1287, steps/s=1.44, kt/s=47.24, trained_tokens=65.40 MT, remained_tokens=704.60 MT]
=== Function Timing Statistics ===
Step: 500
Total time: 1315.51 seconds
Function breakdown:
train_step                    :   657.87s ( 50.0%) | Calls:   2000 | Avg:   328.94ms
get_student_outputs           :   657.48s ( 50.0%) | Calls:   2000 | Avg:   328.74ms
get_attn_loss                 :     0.16s (  0.0%) | Calls:   2000 | Avg:     0.08ms
================================
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000 at epoch 0 step 2000 rank 0
[2024-12-14 01:38:26,479] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_2000 is about to be saved!
[2024-12-14 01:38:26,487] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/zero_pp_rank_0_mp_rank_00_model_states.pt

Epoch 0:   3%| | 500/16003 [25:39<13:51:25,  3.22s/it, loss=0.1286, steps/s=0.87, kt/s=28.46, trained_tokens=65.54 MT, remained_tokens=704.46 MT]
[2024-12-14 01:38:26,852] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 01:38:26,854] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 01:38:27,336] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 01:38:27,337] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_2000/epoch_0_step_2000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt




































































































Epoch 0:   4%| | 599/16003 [30:43<12:34:41,  2.94s/it, loss=0.1241, steps/s=1.44, kt/s=47.20, trained_tokens=78.51 MT, remained_tokens=691.49 MT]
=== Function Timing Statistics ===
Step: 600
Total time: 1577.44 seconds
Function breakdown:
train_step                    :   788.86s ( 50.0%) | Calls:   2400 | Avg:   328.69ms
get_student_outputs           :   788.39s ( 50.0%) | Calls:   2400 | Avg:   328.50ms
get_attn_loss                 :     0.19s (  0.0%) | Calls:   2400 | Avg:     0.08ms









































































































Epoch 0:   4%| | 699/16003 [35:50<12:29:39,  2.94s/it, loss=0.1203, steps/s=1.43, kt/s=46.85, trained_tokens=91.62 MT, remained_tokens=678.38 MT]
=== Function Timing Statistics ===
Step: 700
Total time: 1838.80 seconds
Function breakdown:
train_step                    :   919.56s ( 50.0%) | Calls:   2800 | Avg:   328.41ms
get_student_outputs           :   919.02s ( 50.0%) | Calls:   2800 | Avg:   328.22ms
get_attn_loss                 :     0.22s (  0.0%) | Calls:   2800 | Avg:     0.08ms







































































































Epoch 0:   5%| | 799/16003 [40:56<12:25:28,  2.94s/it, loss=0.1171, steps/s=1.44, kt/s=47.06, trained_tokens=104.73 MT, remained_tokens=665.27 MT
=== Function Timing Statistics ===
Step: 800
Total time: 2101.19 seconds
Function breakdown:
train_step                    :  1050.78s ( 50.0%) | Calls:   3200 | Avg:   328.37ms
get_student_outputs           :  1050.17s ( 50.0%) | Calls:   3200 | Avg:   328.18ms
get_attn_loss                 :     0.25s (  0.0%) | Calls:   3200 | Avg:     0.08ms





































































































Epoch 0:   6%| | 899/16003 [46:02<12:22:23,  2.95s/it, loss=0.1142, steps/s=1.44, kt/s=47.04, trained_tokens=117.83 MT, remained_tokens=652.17 MT
=== Function Timing Statistics ===
Step: 900
Total time: 2363.33 seconds
Function breakdown:
train_step                    :  1181.87s ( 50.0%) | Calls:   3600 | Avg:   328.30ms
get_student_outputs           :  1181.18s ( 50.0%) | Calls:   3600 | Avg:   328.11ms
get_attn_loss                 :     0.28s (  0.0%) | Calls:   3600 | Avg:     0.08ms





































































































Epoch 0:   6%| | 1000/16003 [51:13<13:23:45,  3.21s/it, loss=0.1117, steps/s=0.87, kt/s=28.45, trained_tokens=131.07 MT, remained_tokens=638.93 M
=== Function Timing Statistics ===
Step: 1000
Total time: 2624.91 seconds
Function breakdown:
train_step                    :  1312.68s ( 50.0%) | Calls:   4000 | Avg:   328.17ms
get_student_outputs           :  1311.91s ( 50.0%) | Calls:   4000 | Avg:   327.98ms
get_attn_loss                 :     0.31s (  0.0%) | Calls:   4000 | Avg:     0.08ms
================================
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000 at epoch 0 step 4000 rank 0
[2024-12-14 02:04:00,139] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_4000 is about to be saved!
[2024-12-14 02:04:00,146] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 02:04:00,147] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 02:04:00,502] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 02:04:00,512] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 02:04:00,911] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 02:04:00,912] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_4000/epoch_0_step_4000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:   7%| | 1099/16003 [56:16<12:10:00,  2.94s/it, loss=0.1094, steps/s=1.43, kt/s=46.99, trained_tokens=144.05 MT, remained_tokens=625.95 M
=== Function Timing Statistics ===
Step: 1100
Total time: 2886.26 seconds
Function breakdown:
train_step                    :  1443.38s ( 50.0%) | Calls:   4400 | Avg:   328.04ms
get_student_outputs           :  1442.53s ( 50.0%) | Calls:   4400 | Avg:   327.85ms
get_attn_loss                 :     0.35s (  0.0%) | Calls:   4400 | Avg:     0.08ms








































































































Epoch 0:   7%| | 1200/16003 [1:01:27<13:12:01,  3.21s/it, loss=0.1073, steps/s=0.87, kt/s=28.54, trained_tokens=157.29 MT, remained_tokens=612.71
=== Function Timing Statistics ===
Step: 1200
Total time: 3148.51 seconds
Function breakdown:
train_step                    :  1574.53s ( 50.0%) | Calls:   4800 | Avg:   328.03ms
get_student_outputs           :  1573.61s ( 50.0%) | Calls:   4800 | Avg:   327.83ms
get_attn_loss                 :     0.38s (  0.0%) | Calls:   4800 | Avg:     0.08ms



































































































Epoch 0:   8%| | 1299/16003 [1:06:30<12:07:01,  2.97s/it, loss=0.1054, steps/s=1.43, kt/s=46.90, trained_tokens=170.26 MT, remained_tokens=599.74
=== Function Timing Statistics ===
Step: 1300
Total time: 3410.78 seconds
Function breakdown:
train_step                    :  1705.68s ( 50.0%) | Calls:   5200 | Avg:   328.02ms
get_student_outputs           :  1704.69s ( 50.0%) | Calls:   5200 | Avg:   327.83ms
get_attn_loss                 :     0.41s (  0.0%) | Calls:   5200 | Avg:     0.08ms







































































































Epoch 0:   9%| | 1400/16003 [1:11:42<13:03:44,  3.22s/it, loss=0.1037, steps/s=0.87, kt/s=28.56, trained_tokens=183.50 MT, remained_tokens=586.50
=== Function Timing Statistics ===
Step: 1400
Total time: 3674.16 seconds
Function breakdown:
train_step                    :  1837.40s ( 50.0%) | Calls:   5600 | Avg:   328.11ms
get_student_outputs           :  1836.33s ( 50.0%) | Calls:   5600 | Avg:   327.92ms
get_attn_loss                 :     0.44s (  0.0%) | Calls:   5600 | Avg:     0.08ms




































































































Epoch 0:   9%| | 1499/16003 [1:16:45<11:54:35,  2.96s/it, loss=0.1022, steps/s=1.43, kt/s=46.79, trained_tokens=196.48 MT, remained_tokens=573.52
=== Function Timing Statistics ===
Step: 1500
Total time: 3935.88 seconds
Function breakdown:
train_step                    :  1968.28s ( 50.0%) | Calls:   6000 | Avg:   328.05ms
get_student_outputs           :  1967.13s ( 50.0%) | Calls:   6000 | Avg:   327.86ms
get_attn_loss                 :     0.47s (  0.0%) | Calls:   6000 | Avg:     0.08ms

Epoch 0:   9%| | 1500/16003 [1:16:49<13:01:27,  3.23s/it, loss=0.1022, steps/s=0.86, kt/s=28.28, trained_tokens=196.61 MT, remained_tokens=573.39
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000 at epoch 0 step 6000 rank 0
[2024-12-14 02:29:36,256] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_6000 is about to be saved!
[2024-12-14 02:29:36,265] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 02:29:36,266] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 02:29:36,629] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 02:29:36,631] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 02:29:37,103] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 02:29:37,104] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_6000/epoch_0_step_6000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:  10%| | 1599/16003 [1:21:53<11:43:33,  2.93s/it, loss=0.1007, steps/s=1.44, kt/s=47.21, trained_tokens=209.58 MT, remained_tokens=560.42
=== Function Timing Statistics ===
Step: 1600
Total time: 4197.71 seconds
Function breakdown:
train_step                    :  2099.22s ( 50.0%) | Calls:   6400 | Avg:   328.00ms
get_student_outputs           :  2097.99s ( 50.0%) | Calls:   6400 | Avg:   327.81ms
get_attn_loss                 :     0.50s (  0.0%) | Calls:   6400 | Avg:     0.08ms







































































































Epoch 0:  11%| | 1700/16003 [1:27:04<12:48:04,  3.22s/it, loss=0.0993, steps/s=0.85, kt/s=27.97, trained_tokens=222.82 MT, remained_tokens=547.18
=== Function Timing Statistics ===
Step: 1700
Total time: 4460.60 seconds
Function breakdown:
train_step                    :  2230.69s ( 50.0%) | Calls:   6800 | Avg:   328.04ms
get_student_outputs           :  2229.38s ( 50.0%) | Calls:   6800 | Avg:   327.85ms
get_attn_loss                 :     0.53s (  0.0%) | Calls:   6800 | Avg:     0.08ms







































































































Epoch 0:  11%| | 1800/16003 [1:32:12<12:39:21,  3.21s/it, loss=0.0980, steps/s=0.89, kt/s=29.01, trained_tokens=235.93 MT, remained_tokens=534.07
=== Function Timing Statistics ===
Step: 1800
Total time: 4722.75 seconds
Function breakdown:
train_step                    :  2361.78s ( 50.0%) | Calls:   7200 | Avg:   328.03ms
get_student_outputs           :  2360.40s ( 50.0%) | Calls:   7200 | Avg:   327.83ms
get_attn_loss                 :     0.56s (  0.0%) | Calls:   7200 | Avg:     0.08ms





































































































Epoch 0:  12%| | 1900/16003 [1:37:18<12:34:50,  3.21s/it, loss=0.0968, steps/s=0.88, kt/s=28.94, trained_tokens=249.04 MT, remained_tokens=520.96
=== Function Timing Statistics ===
Step: 1900
Total time: 4984.78 seconds
Function breakdown:
train_step                    :  2492.82s ( 50.0%) | Calls:   7600 | Avg:   328.00ms
get_student_outputs           :  2491.36s ( 50.0%) | Calls:   7600 | Avg:   327.81ms
get_attn_loss                 :     0.60s (  0.0%) | Calls:   7600 | Avg:     0.08ms





































































































Epoch 0:  12%| | 1999/16003 [1:42:21<11:26:39,  2.94s/it, loss=0.0956, steps/s=1.43, kt/s=46.74, trained_tokens=262.01 MT, remained_tokens=507.99
=== Function Timing Statistics ===
Step: 2000
Total time: 5247.56 seconds
Function breakdown:
train_step                    :  2624.23s ( 50.0%) | Calls:   8000 | Avg:   328.03ms
get_student_outputs           :  2622.70s ( 50.0%) | Calls:   8000 | Avg:   327.84ms
get_attn_loss                 :     0.63s (  0.0%) | Calls:   8000 | Avg:     0.08ms

Epoch 0:  12%| | 2000/16003 [1:42:25<12:29:20,  3.21s/it, loss=0.0956, steps/s=0.86, kt/s=28.07, trained_tokens=262.14 MT, remained_tokens=507.86
deleting older checkpoints epoch_0_step_2000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000 at epoch 0 step 8000 rank 0
[2024-12-14 02:55:12,571] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_8000 is about to be saved!
[2024-12-14 02:55:12,580] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 02:55:12,580] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 02:55:12,936] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 02:55:12,955] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 02:55:13,426] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 02:55:13,426] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_8000/epoch_0_step_8000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt








































































































Epoch 0:  13%|▏| 2099/16003 [1:47:29<11:21:29,  2.94s/it, loss=0.0946, steps/s=1.43, kt/s=46.99, trained_tokens=275.12 MT, remained_tokens=494.88
=== Function Timing Statistics ===
Step: 2100
Total time: 5508.63 seconds
Function breakdown:
train_step                    :  2754.79s ( 50.0%) | Calls:   8400 | Avg:   327.95ms
get_student_outputs           :  2753.18s ( 50.0%) | Calls:   8400 | Avg:   327.76ms
get_attn_loss                 :     0.66s (  0.0%) | Calls:   8400 | Avg:     0.08ms






































































































Epoch 0:  14%|▏| 2199/16003 [1:52:36<11:18:10,  2.95s/it, loss=0.0935, steps/s=1.44, kt/s=47.05, trained_tokens=288.23 MT, remained_tokens=481.77
=== Function Timing Statistics ===
Step: 2200
Total time: 5771.05 seconds
Function breakdown:
train_step                    :  2886.02s ( 50.0%) | Calls:   8800 | Avg:   327.96ms
get_student_outputs           :  2884.33s ( 50.0%) | Calls:   8800 | Avg:   327.77ms
get_attn_loss                 :     0.69s (  0.0%) | Calls:   8800 | Avg:     0.08ms








































































































Epoch 0:  14%|▏| 2300/16003 [1:57:48<12:16:34,  3.23s/it, loss=0.0925, steps/s=0.84, kt/s=27.52, trained_tokens=301.47 MT, remained_tokens=468.53
=== Function Timing Statistics ===
Step: 2300
Total time: 6034.15 seconds
Function breakdown:
train_step                    :  3017.60s ( 50.0%) | Calls:   9200 | Avg:   328.00ms
get_student_outputs           :  3015.83s ( 50.0%) | Calls:   9200 | Avg:   327.81ms
get_attn_loss                 :     0.72s (  0.0%) | Calls:   9200 | Avg:     0.08ms






































































































Epoch 0:  15%|▏| 2400/16003 [2:02:55<12:12:24,  3.23s/it, loss=0.0916, steps/s=0.88, kt/s=28.96, trained_tokens=314.57 MT, remained_tokens=455.43
=== Function Timing Statistics ===
Step: 2400
Total time: 6296.00 seconds
Function breakdown:
train_step                    :  3148.54s ( 50.0%) | Calls:   9600 | Avg:   327.97ms
get_student_outputs           :  3146.70s ( 50.0%) | Calls:   9600 | Avg:   327.78ms
get_attn_loss                 :     0.76s (  0.0%) | Calls:   9600 | Avg:     0.08ms





































































































Epoch 0:  16%|▏| 2499/16003 [2:07:58<11:02:38,  2.94s/it, loss=0.0907, steps/s=1.44, kt/s=47.09, trained_tokens=327.55 MT, remained_tokens=442.45
=== Function Timing Statistics ===
Step: 2500
Total time: 6558.29 seconds
Function breakdown:
train_step                    :  3279.71s ( 50.0%) | Calls:  10000 | Avg:   327.97ms
get_student_outputs           :  3277.79s ( 50.0%) | Calls:  10000 | Avg:   327.78ms
get_attn_loss                 :     0.79s (  0.0%) | Calls:  10000 | Avg:     0.08ms
================================

Epoch 0:  16%|▏| 2500/16003 [2:08:02<12:05:24,  3.22s/it, loss=0.0907, steps/s=0.85, kt/s=27.69, trained_tokens=327.68 MT, remained_tokens=442.32
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000 at epoch 0 step 10000 rank 0
[2024-12-14 03:20:50,091] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_10000 is about to be saved!
[2024-12-14 03:20:50,099] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 03:20:50,099] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 03:20:50,465] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 03:20:50,467] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 03:20:50,941] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 03:20:50,942] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_10000/epoch_0_step_10000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt




































































































Epoch 0:  16%|▏| 2599/16003 [2:13:07<10:57:41,  2.94s/it, loss=0.0898, steps/s=1.43, kt/s=46.92, trained_tokens=340.66 MT, remained_tokens=429.34
=== Function Timing Statistics ===
Step: 2600
Total time: 6819.98 seconds
Function breakdown:
train_step                    :  3410.59s ( 50.0%) | Calls:  10400 | Avg:   327.94ms
get_student_outputs           :  3408.58s ( 50.0%) | Calls:  10400 | Avg:   327.75ms
get_attn_loss                 :     0.82s (  0.0%) | Calls:  10400 | Avg:     0.08ms




































































































Epoch 0:  17%|▏| 2699/16003 [2:18:14<10:49:41,  2.93s/it, loss=0.0890, steps/s=1.44, kt/s=47.34, trained_tokens=353.76 MT, remained_tokens=416.24
=== Function Timing Statistics ===
Step: 2700
Total time: 7082.31 seconds
Function breakdown:
train_step                    :  3541.77s ( 50.0%) | Calls:  10800 | Avg:   327.94ms
get_student_outputs           :  3539.69s ( 50.0%) | Calls:  10800 | Avg:   327.75ms
get_attn_loss                 :     0.85s (  0.0%) | Calls:  10800 | Avg:     0.08ms







































































































Epoch 0:  17%|▏| 2800/16003 [2:23:25<11:50:10,  3.23s/it, loss=0.0882, steps/s=0.86, kt/s=28.15, trained_tokens=367.00 MT, remained_tokens=403.00
=== Function Timing Statistics ===
Step: 2800
Total time: 7344.09 seconds
Function breakdown:
train_step                    :  3672.68s ( 50.0%) | Calls:  11200 | Avg:   327.92ms
get_student_outputs           :  3670.52s ( 50.0%) | Calls:  11200 | Avg:   327.72ms
get_attn_loss                 :     0.89s (  0.0%) | Calls:  11200 | Avg:     0.08ms





































































































Epoch 0:  18%|▏| 2899/16003 [2:28:28<10:41:02,  2.94s/it, loss=0.0875, steps/s=1.44, kt/s=47.30, trained_tokens=379.98 MT, remained_tokens=390.02
=== Function Timing Statistics ===
Step: 2900
Total time: 7606.09 seconds
Function breakdown:
train_step                    :  3803.71s ( 50.0%) | Calls:  11600 | Avg:   327.91ms
get_student_outputs           :  3801.46s ( 50.0%) | Calls:  11600 | Avg:   327.71ms
get_attn_loss                 :     0.92s (  0.0%) | Calls:  11600 | Avg:     0.08ms








































































































Epoch 0:  19%|▏| 3000/16003 [2:33:40<11:39:52,  3.23s/it, loss=0.0867, steps/s=0.84, kt/s=27.58, trained_tokens=393.22 MT, remained_tokens=376.78
=== Function Timing Statistics ===
Step: 3000
Total time: 7868.38 seconds
Function breakdown:
train_step                    :  3934.88s ( 50.0%) | Calls:  12000 | Avg:   327.91ms
get_student_outputs           :  3932.55s ( 50.0%) | Calls:  12000 | Avg:   327.71ms
get_attn_loss                 :     0.95s (  0.0%) | Calls:  12000 | Avg:     0.08ms
================================
deleting older checkpoints epoch_0_step_6000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000 at epoch 0 step 12000 rank 0
[2024-12-14 03:46:27,650] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_12000 is about to be saved!
[2024-12-14 03:46:27,658] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 03:46:27,658] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 03:46:28,023] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 03:46:28,025] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 03:46:28,488] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 03:46:28,488] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_12000/epoch_0_step_12000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt






































































































Epoch 0:  19%|▏| 3099/16003 [2:38:44<10:31:33,  2.94s/it, loss=0.0861, steps/s=1.44, kt/s=47.03, trained_tokens=406.19 MT, remained_tokens=363.81
=== Function Timing Statistics ===
Step: 3100
Total time: 8131.43 seconds
Function breakdown:
train_step                    :  4066.42s ( 50.0%) | Calls:  12400 | Avg:   327.94ms
get_student_outputs           :  4064.02s ( 50.0%) | Calls:  12400 | Avg:   327.74ms
get_attn_loss                 :     0.99s (  0.0%) | Calls:  12400 | Avg:     0.08ms





































































































Epoch 0:  20%|▏| 3199/16003 [2:43:52<10:32:02,  2.96s/it, loss=0.0854, steps/s=1.44, kt/s=47.10, trained_tokens=419.30 MT, remained_tokens=350.70
=== Function Timing Statistics ===
Step: 3200
Total time: 8394.71 seconds
Function breakdown:
train_step                    :  4198.09s ( 50.0%) | Calls:  12800 | Avg:   327.98ms
get_student_outputs           :  4195.60s ( 50.0%) | Calls:  12800 | Avg:   327.78ms
get_attn_loss                 :     1.02s (  0.0%) | Calls:  12800 | Avg:     0.08ms






































































































Epoch 0:  21%|▏| 3299/16003 [2:49:01<10:26:55,  2.96s/it, loss=0.0848, steps/s=1.42, kt/s=46.47, trained_tokens=432.41 MT, remained_tokens=337.59
=== Function Timing Statistics ===
Step: 3300
Total time: 8658.20 seconds
Function breakdown:
train_step                    :  4329.86s ( 50.0%) | Calls:  13200 | Avg:   328.02ms
get_student_outputs           :  4327.29s ( 50.0%) | Calls:  13200 | Avg:   327.83ms
get_attn_loss                 :     1.05s (  0.0%) | Calls:  13200 | Avg:     0.08ms





































































































Epoch 0:  21%|▏| 3399/16003 [2:54:09<10:20:58,  2.96s/it, loss=0.0841, steps/s=1.42, kt/s=46.48, trained_tokens=445.51 MT, remained_tokens=324.49
=== Function Timing Statistics ===
Step: 3400
Total time: 8920.97 seconds
Function breakdown:
train_step                    :  4461.26s ( 50.0%) | Calls:  13600 | Avg:   328.03ms
get_student_outputs           :  4458.62s ( 50.0%) | Calls:  13600 | Avg:   327.84ms
get_attn_loss                 :     1.08s (  0.0%) | Calls:  13600 | Avg:     0.08ms








































































































Epoch 0:  22%|▏| 3500/16003 [2:59:20<11:11:55,  3.22s/it, loss=0.0835, steps/s=0.88, kt/s=28.69, trained_tokens=458.75 MT, remained_tokens=311.25
=== Function Timing Statistics ===
Step: 3500
Total time: 9183.33 seconds
Function breakdown:
train_step                    :  4592.47s ( 50.0%) | Calls:  14000 | Avg:   328.03ms
get_student_outputs           :  4589.75s ( 50.0%) | Calls:  14000 | Avg:   327.84ms
get_attn_loss                 :     1.12s (  0.0%) | Calls:  14000 | Avg:     0.08ms
================================
deleting older checkpoints epoch_0_step_8000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000 at epoch 0 step 14000 rank 0
[2024-12-14 04:12:08,295] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_14000 is about to be saved!
[2024-12-14 04:12:08,303] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 04:12:08,303] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 04:12:08,666] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 04:12:08,674] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 04:12:09,073] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 04:12:09,073] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_14000/epoch_0_step_14000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt




































































































Epoch 0:  22%|▏| 3600/16003 [3:04:29<11:04:30,  3.21s/it, loss=0.0829, steps/s=0.87, kt/s=28.59, trained_tokens=471.86 MT, remained_tokens=298.14
=== Function Timing Statistics ===
Step: 3600
Total time: 9446.07 seconds
Function breakdown:
train_step                    :  4723.86s ( 50.0%) | Calls:  14400 | Avg:   328.05ms
get_student_outputs           :  4721.06s ( 50.0%) | Calls:  14400 | Avg:   327.85ms
get_attn_loss                 :     1.15s (  0.0%) | Calls:  14400 | Avg:     0.08ms



































































































Epoch 0:  23%|▏| 3699/16003 [3:09:33<10:00:58,  2.93s/it, loss=0.0824, steps/s=1.45, kt/s=47.49, trained_tokens=484.84 MT, remained_tokens=285.16
=== Function Timing Statistics ===
Step: 3700
Total time: 9708.59 seconds
Function breakdown:
train_step                    :  4855.14s ( 50.0%) | Calls:  14800 | Avg:   328.05ms
get_student_outputs           :  4852.27s ( 50.0%) | Calls:  14800 | Avg:   327.86ms
get_attn_loss                 :     1.18s (  0.0%) | Calls:  14800 | Avg:     0.08ms








































































































Epoch 0:  24%|▏| 3800/16003 [3:14:44<10:50:08,  3.20s/it, loss=0.0818, steps/s=0.87, kt/s=28.45, trained_tokens=498.07 MT, remained_tokens=271.93
=== Function Timing Statistics ===
Step: 3800
Total time: 9971.16 seconds
Function breakdown:
train_step                    :  4986.45s ( 50.0%) | Calls:  15200 | Avg:   328.06ms
get_student_outputs           :  4983.50s ( 50.0%) | Calls:  15200 | Avg:   327.86ms
get_attn_loss                 :     1.21s (  0.0%) | Calls:  15200 | Avg:     0.08ms









































































































Epoch 0:  24%|▏| 3900/16003 [3:19:53<10:49:46,  3.22s/it, loss=0.0813, steps/s=0.87, kt/s=28.42, trained_tokens=511.18 MT, remained_tokens=258.82
=== Function Timing Statistics ===
Step: 3900
Total time: 10234.01 seconds
Function breakdown:
train_step                    :  5117.90s ( 50.0%) | Calls:  15600 | Avg:   328.07ms
get_student_outputs           :  5114.87s ( 50.0%) | Calls:  15600 | Avg:   327.88ms
get_attn_loss                 :     1.25s (  0.0%) | Calls:  15600 | Avg:     0.08ms






































































































Epoch 0:  25%|▏| 4000/16003 [3:25:00<10:40:45,  3.20s/it, loss=0.0808, steps/s=0.86, kt/s=28.10, trained_tokens=524.29 MT, remained_tokens=245.71
=== Function Timing Statistics ===
Step: 4000
Total time: 10496.98 seconds
Function breakdown:
train_step                    :  5249.40s ( 50.0%) | Calls:  16000 | Avg:   328.09ms
get_student_outputs           :  5246.30s ( 50.0%) | Calls:  16000 | Avg:   327.89ms
get_attn_loss                 :     1.28s (  0.0%) | Calls:  16000 | Avg:     0.08ms
================================
deleting older checkpoints epoch_0_step_10000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000 at epoch 0 step 16000 rank 0
[2024-12-14 04:37:47,904] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_16000 is about to be saved!
[2024-12-14 04:37:47,912] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 04:37:47,912] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 04:37:48,273] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 04:37:48,276] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 04:37:48,673] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 04:37:48,674] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_16000/epoch_0_step_16000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt





































































































Epoch 0:  26%|▎| 4100/16003 [3:30:08<10:41:05,  3.23s/it, loss=0.0803, steps/s=0.86, kt/s=28.22, trained_tokens=537.40 MT, remained_tokens=232.60
=== Function Timing Statistics ===
Step: 4100
Total time: 10759.02 seconds
Function breakdown:
train_step                    :  5380.44s ( 50.0%) | Calls:  16400 | Avg:   328.08ms
get_student_outputs           :  5377.27s ( 50.0%) | Calls:  16400 | Avg:   327.88ms
get_attn_loss                 :     1.31s (  0.0%) | Calls:  16400 | Avg:     0.08ms





































































































Epoch 0:  26%|▎| 4200/16003 [3:35:15<10:37:11,  3.24s/it, loss=0.0798, steps/s=0.86, kt/s=28.31, trained_tokens=550.50 MT, remained_tokens=219.50
=== Function Timing Statistics ===
Step: 4200
Total time: 11021.90 seconds
Function breakdown:
train_step                    :  5511.90s ( 50.0%) | Calls:  16800 | Avg:   328.09ms
get_student_outputs           :  5508.65s ( 50.0%) | Calls:  16800 | Avg:   327.90ms
get_attn_loss                 :     1.34s (  0.0%) | Calls:  16800 | Avg:     0.08ms





































































































Epoch 0:  27%|▎| 4300/16003 [3:40:22<10:24:40,  3.20s/it, loss=0.0793, steps/s=0.89, kt/s=29.11, trained_tokens=563.61 MT, remained_tokens=206.39
=== Function Timing Statistics ===
Step: 4300
Total time: 11285.61 seconds
Function breakdown:
train_step                    :  5643.78s ( 50.0%) | Calls:  17200 | Avg:   328.13ms
get_student_outputs           :  5640.45s ( 50.0%) | Calls:  17200 | Avg:   327.93ms
get_attn_loss                 :     1.38s (  0.0%) | Calls:  17200 | Avg:     0.08ms



































































































Epoch 0:  27%|▎| 4399/16003 [3:45:27<9:32:38,  2.96s/it, loss=0.0789, steps/s=1.42, kt/s=46.47, trained_tokens=576.59 MT, remained_tokens=193.41
=== Function Timing Statistics ===
Step: 4400
Total time: 11550.72 seconds
Function breakdown:
train_step                    :  5776.36s ( 50.0%) | Calls:  17600 | Avg:   328.20ms
get_student_outputs           :  5772.95s ( 50.0%) | Calls:  17600 | Avg:   328.01ms
get_attn_loss                 :     1.41s (  0.0%) | Calls:  17600 | Avg:     0.08ms





































































































Epoch 0:  28%|▎| 4499/16003 [3:50:35<9:24:56,  2.95s/it, loss=0.0784, steps/s=1.44, kt/s=47.11, trained_tokens=589.69 MT, remained_tokens=180.31
=== Function Timing Statistics ===
Step: 4500
Total time: 11814.09 seconds
Function breakdown:
train_step                    :  5908.07s ( 50.0%) | Calls:  18000 | Avg:   328.23ms
get_student_outputs           :  5904.58s ( 50.0%) | Calls:  18000 | Avg:   328.03ms
get_attn_loss                 :     1.44s (  0.0%) | Calls:  18000 | Avg:     0.08ms
================================

Epoch 0:  28%|▎| 4500/16003 [3:50:39<10:18:15,  3.22s/it, loss=0.0784, steps/s=0.86, kt/s=28.12, trained_tokens=589.82 MT, remained_tokens=180.18
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_18000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_18000 at epoch 0 step 18000 rank 0
[2024-12-14 05:03:27,207] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_18000 is about to be saved!
[2024-12-14 05:03:27,216] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_18000/epoch_0_step_18000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 05:03:27,216] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_18000/epoch_0_step_18000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 05:03:27,582] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_18000/epoch_0_step_18000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 05:03:27,598] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_18000/epoch_0_step_18000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 05:03:28,068] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_18000/epoch_0_step_18000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 05:03:28,069] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_18000/epoch_0_step_18000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt






































































































Epoch 0:  29%|▎| 4599/16003 [3:55:44<9:27:55,  2.99s/it, loss=0.0780, steps/s=1.40, kt/s=45.77, trained_tokens=602.80 MT, remained_tokens=167.20
=== Function Timing Statistics ===
Step: 4600
Total time: 12076.43 seconds
Function breakdown:
train_step                    :  6039.26s ( 50.0%) | Calls:  18400 | Avg:   328.22ms
get_student_outputs           :  6035.70s ( 50.0%) | Calls:  18400 | Avg:   328.03ms
get_attn_loss                 :     1.48s (  0.0%) | Calls:  18400 | Avg:     0.08ms





































































































Epoch 0:  29%|▎| 4699/16003 [4:00:51<9:18:10,  2.96s/it, loss=0.0776, steps/s=1.43, kt/s=46.70, trained_tokens=615.91 MT, remained_tokens=154.09
=== Function Timing Statistics ===
Step: 4700
Total time: 12339.10 seconds
Function breakdown:
train_step                    :  6170.61s ( 50.0%) | Calls:  18800 | Avg:   328.22ms
get_student_outputs           :  6166.98s ( 50.0%) | Calls:  18800 | Avg:   328.03ms
get_attn_loss                 :     1.51s (  0.0%) | Calls:  18800 | Avg:     0.08ms







































































































Epoch 0:  30%|▎| 4799/16003 [4:05:59<9:10:04,  2.95s/it, loss=0.0772, steps/s=1.43, kt/s=46.97, trained_tokens=629.01 MT, remained_tokens=140.99
=== Function Timing Statistics ===
Step: 4800
Total time: 12602.15 seconds
Function breakdown:
train_step                    :  6302.16s ( 50.0%) | Calls:  19200 | Avg:   328.24ms
get_student_outputs           :  6298.45s ( 50.0%) | Calls:  19200 | Avg:   328.04ms
get_attn_loss                 :     1.54s (  0.0%) | Calls:  19200 | Avg:     0.08ms







































































































Epoch 0:  31%|▎| 4899/16003 [4:11:07<9:09:47,  2.97s/it, loss=0.0768, steps/s=1.43, kt/s=46.89, trained_tokens=642.12 MT, remained_tokens=127.88
=== Function Timing Statistics ===
Step: 4900
Total time: 12865.19 seconds
Function breakdown:
train_step                    :  6433.70s ( 50.0%) | Calls:  19600 | Avg:   328.25ms
get_student_outputs           :  6429.91s ( 50.0%) | Calls:  19600 | Avg:   328.06ms
get_attn_loss                 :     1.57s (  0.0%) | Calls:  19600 | Avg:     0.08ms









































































































Epoch 0:  31%|▎| 5000/16003 [4:16:18<9:51:48,  3.23s/it, loss=0.0764, steps/s=0.85, kt/s=27.77, trained_tokens=655.36 MT, remained_tokens=114.64
=== Function Timing Statistics ===
Step: 5000
Total time: 13128.83 seconds
Function breakdown:
train_step                    :  6565.55s ( 50.0%) | Calls:  20000 | Avg:   328.28ms
get_student_outputs           :  6561.68s ( 50.0%) | Calls:  20000 | Avg:   328.08ms
get_attn_loss                 :     1.61s (  0.0%) | Calls:  20000 | Avg:     0.08ms
================================
deleting older checkpoints epoch_0_step_14000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_20000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_20000 at epoch 0 step 20000 rank 0
[2024-12-14 05:29:06,211] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_20000 is about to be saved!
[2024-12-14 05:29:06,219] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_20000/epoch_0_step_20000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 05:29:06,219] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_20000/epoch_0_step_20000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 05:29:06,584] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_20000/epoch_0_step_20000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 05:29:06,591] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_20000/epoch_0_step_20000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 05:29:06,983] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_20000/epoch_0_step_20000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 05:29:06,984] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_20000/epoch_0_step_20000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt




































































































Epoch 0:  32%|▎| 5099/16003 [4:21:23<8:57:19,  2.96s/it, loss=0.0760, steps/s=1.42, kt/s=46.41, trained_tokens=668.34 MT, remained_tokens=101.66
=== Function Timing Statistics ===
Step: 5100
Total time: 13391.09 seconds
Function breakdown:
train_step                    :  6696.70s ( 50.0%) | Calls:  20400 | Avg:   328.27ms
get_student_outputs           :  6692.76s ( 50.0%) | Calls:  20400 | Avg:   328.08ms
get_attn_loss                 :     1.64s (  0.0%) | Calls:  20400 | Avg:     0.08ms









































































































Epoch 0:  32%|▎| 5200/16003 [4:26:35<9:43:07,  3.24s/it, loss=0.0756, steps/s=0.84, kt/s=27.65, trained_tokens=681.57 MT, remained_tokens=88.43 M
=== Function Timing Statistics ===
Step: 5200
Total time: 13654.05 seconds
Function breakdown:
train_step                    :  6828.20s ( 50.0%) | Calls:  20800 | Avg:   328.28ms
get_student_outputs           :  6824.18s ( 50.0%) | Calls:  20800 | Avg:   328.09ms
get_attn_loss                 :     1.67s (  0.0%) | Calls:  20800 | Avg:     0.08ms




































































































Epoch 0:  33%|▎| 5300/16003 [4:31:43<9:33:23,  3.21s/it, loss=0.0753, steps/s=0.87, kt/s=28.46, trained_tokens=694.68 MT, remained_tokens=75.32 M
=== Function Timing Statistics ===
Step: 5300
Total time: 13917.43 seconds
Function breakdown:
train_step                    :  6959.91s ( 50.0%) | Calls:  21200 | Avg:   328.30ms
get_student_outputs           :  6955.82s ( 50.0%) | Calls:  21200 | Avg:   328.10ms
get_attn_loss                 :     1.71s (  0.0%) | Calls:  21200 | Avg:     0.08ms






































































































Epoch 0:  34%|▎| 5400/16003 [4:36:51<9:32:11,  3.24s/it, loss=0.0749, steps/s=0.87, kt/s=28.41, trained_tokens=707.79 MT, remained_tokens=62.21 M
=== Function Timing Statistics ===
Step: 5400
Total time: 14181.17 seconds
Function breakdown:
train_step                    :  7091.80s ( 50.0%) | Calls:  21600 | Avg:   328.32ms
get_student_outputs           :  7087.63s ( 50.0%) | Calls:  21600 | Avg:   328.13ms
get_attn_loss                 :     1.74s (  0.0%) | Calls:  21600 | Avg:     0.08ms




































































































Epoch 0:  34%|▎| 5499/16003 [4:41:56<8:39:54,  2.97s/it, loss=0.0746, steps/s=1.42, kt/s=46.55, trained_tokens=720.76 MT, remained_tokens=49.24 M
=== Function Timing Statistics ===
Step: 5500
Total time: 14445.65 seconds
Function breakdown:
train_step                    :  7224.06s ( 50.0%) | Calls:  22000 | Avg:   328.37ms
get_student_outputs           :  7219.81s ( 50.0%) | Calls:  22000 | Avg:   328.17ms
get_attn_loss                 :     1.77s (  0.0%) | Calls:  22000 | Avg:     0.08ms

Epoch 0:  34%|▎| 5500/16003 [4:41:59<9:28:03,  3.25s/it, loss=0.0746, steps/s=0.86, kt/s=28.32, trained_tokens=720.90 MT, remained_tokens=49.10 M
deleting older checkpoints epoch_0_step_16000
saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_22000
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_22000 at epoch 0 step 22000 rank 0
[2024-12-14 05:54:47,458] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint epoch_0_step_22000 is about to be saved!
[2024-12-14 05:54:47,468] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_22000/epoch_0_step_22000/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 05:54:47,468] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_22000/epoch_0_step_22000/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 05:54:47,830] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_22000/epoch_0_step_22000/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 05:54:47,837] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_22000/epoch_0_step_22000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 05:54:48,223] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_22000/epoch_0_step_22000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 05:54:48,224] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/epoch_0_step_22000/epoch_0_step_22000/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt







































































































Epoch 0:  35%|▎| 5600/16003 [4:47:09<9:19:32,  3.23s/it, loss=0.0742, steps/s=0.86, kt/s=28.29, trained_tokens=734.00 MT, remained_tokens=36.00 M
=== Function Timing Statistics ===
Step: 5600
Total time: 14709.81 seconds
Function breakdown:
train_step                    :  7356.16s ( 50.0%) | Calls:  22400 | Avg:   328.40ms
get_student_outputs           :  7351.84s ( 50.0%) | Calls:  22400 | Avg:   328.21ms
get_attn_loss                 :     1.81s (  0.0%) | Calls:  22400 | Avg:     0.08ms






































































































Epoch 0:  36%|▎| 5699/16003 [4:52:12<8:24:44,  2.94s/it, loss=0.0739, steps/s=1.46, kt/s=47.69, trained_tokens=746.98 MT, remained_tokens=23.02 M
=== Function Timing Statistics ===
Step: 5700
Total time: 14972.80 seconds
Function breakdown:
train_step                    :  7487.68s ( 50.0%) | Calls:  22800 | Avg:   328.41ms
get_student_outputs           :  7483.28s ( 50.0%) | Calls:  22800 | Avg:   328.21ms
get_attn_loss                 :     1.84s (  0.0%) | Calls:  22800 | Avg:     0.08ms






































































































Epoch 0:  36%|▎| 5800/16003 [4:57:24<9:03:58,  3.20s/it, loss=0.0736, steps/s=0.88, kt/s=28.76, trained_tokens=760.22 MT, remained_tokens=9.78 MT
=== Function Timing Statistics ===
Step: 5800
Total time: 15235.85 seconds
Function breakdown:
train_step                    :  7619.23s ( 50.0%) | Calls:  23200 | Avg:   328.42ms
get_student_outputs           :  7614.75s ( 50.0%) | Calls:  23200 | Avg:   328.22ms
get_attn_loss                 :     1.87s (  0.0%) | Calls:  23200 | Avg:     0.08ms











































































Epoch 0:  37%|▎| 5874/16003 [5:01:10<8:27:54,  3.01s/it, loss=0.0734, steps/s=1.41, kt/s=46.20, trained_tokens=769.92 MT, remained_tokens=0.08 MT
Saving checkpoint to /home/yueyulin/model/qwen_0.5b_full_layers_stage1 at epoch 0 rank 0
[2024-12-14 06:13:59,887] [INFO] [logging.py:129:log_dist] [Rank 0] [Torch] Checkpoint checkpoint-epoch0 is about to be saved!
[2024-12-14 06:13:59,895] [INFO] [logging.py:129:log_dist] [Rank 0] Saving model checkpoint: /home/yueyulin/model/qwen_0.5b_full_layers_stage1/checkpoint-epoch0/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-12-14 06:13:59,895] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/checkpoint-epoch0/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-12-14 06:14:00,264] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/checkpoint-epoch0/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-12-14 06:14:00,265] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/yueyulin/model/qwen_0.5b_full_layers_stage1/checkpoint-epoch0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-12-14 06:14:00,745] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/checkpoint-epoch0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-12-14 06:14:00,746] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/yueyulin/model/qwen_0.5b_full_layers_stage1/checkpoint-epoch0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-12-14 06:14:00,799] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint checkpoint-epoch0 is ready now!
Terminating training at epoch 0
Training completed