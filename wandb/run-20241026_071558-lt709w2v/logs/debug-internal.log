2024-10-26 07:15:58,943 INFO    StreamThr :2444559 [internal.py:wandb_internal():85] W&B internal server running at pid: 2444559, started at: 2024-10-26 07:15:58.942621
2024-10-26 07:15:58,944 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status
2024-10-26 07:15:58,945 INFO    WriterThread:2444559 [datastore.py:open_for_write():87] open: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/run-lt709w2v.wandb
2024-10-26 07:15:58,946 DEBUG   SenderThread:2444559 [sender.py:send():379] send: header
2024-10-26 07:15:58,950 DEBUG   SenderThread:2444559 [sender.py:send():379] send: run
2024-10-26 07:15:59,769 INFO    SenderThread:2444559 [dir_watcher.py:__init__():211] watching files in: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/files
2024-10-26 07:15:59,769 INFO    SenderThread:2444559 [sender.py:_start_run_threads():1188] run started: lt709w2v with start time 1729926958.942366
2024-10-26 07:15:59,778 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: check_version
2024-10-26 07:15:59,779 DEBUG   SenderThread:2444559 [sender.py:send_request():406] send_request: check_version
2024-10-26 07:16:00,462 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: run_start
2024-10-26 07:16:00,499 DEBUG   HandlerThread:2444559 [system_info.py:__init__():26] System info init
2024-10-26 07:16:00,499 DEBUG   HandlerThread:2444559 [system_info.py:__init__():41] System info init done
2024-10-26 07:16:00,499 INFO    HandlerThread:2444559 [system_monitor.py:start():194] Starting system monitor
2024-10-26 07:16:00,499 INFO    SystemMonitor:2444559 [system_monitor.py:_start():158] Starting system asset monitoring threads
2024-10-26 07:16:00,500 INFO    HandlerThread:2444559 [system_monitor.py:probe():214] Collecting system info
2024-10-26 07:16:00,500 INFO    SystemMonitor:2444559 [interfaces.py:start():188] Started cpu monitoring
2024-10-26 07:16:00,501 INFO    SystemMonitor:2444559 [interfaces.py:start():188] Started disk monitoring
2024-10-26 07:16:00,502 INFO    SystemMonitor:2444559 [interfaces.py:start():188] Started gpu monitoring
2024-10-26 07:16:00,504 INFO    SystemMonitor:2444559 [interfaces.py:start():188] Started memory monitoring
2024-10-26 07:16:00,506 INFO    SystemMonitor:2444559 [interfaces.py:start():188] Started network monitoring
2024-10-26 07:16:00,534 DEBUG   HandlerThread:2444559 [system_info.py:probe():152] Probing system
2024-10-26 07:16:00,536 DEBUG   HandlerThread:2444559 [system_info.py:_probe_git():137] Probing git
2024-10-26 07:16:00,543 DEBUG   HandlerThread:2444559 [system_info.py:_probe_git():145] Probing git done
2024-10-26 07:16:00,543 DEBUG   HandlerThread:2444559 [system_info.py:probe():200] Probing system done
2024-10-26 07:16:00,543 DEBUG   HandlerThread:2444559 [system_monitor.py:probe():223] {'os': 'Linux-5.15.0-119-generic-x86_64-with-glibc2.35', 'python': '3.12.4', 'heartbeatAt': '2024-10-26T07:16:00.534279', 'startedAt': '2024-10-26T07:15:58.937821', 'docker': None, 'cuda': None, 'args': ('--deepspeed', '--deepspeed_offload', '--deepspeed_stage', '3', '--config_file', 'configs/step_wise/test_hybrid_1_layer_qwenmlp-0.5B.yaml', '--output_dir', '/home/yueyulin/tmp/distill_qwen05b_1', '--preprocessed_data', '/home/yueyulin/data/IndustryInstruction_Qwen_0.5B_DS/', '--num_devices', '4', '--num_nodes', '2', '--micro_bsz', '1', '--accumulate_grad_batches', '4', '--max_epochs', '2', '--wandb', 'hybrid_trainer', '--run_name', 'hybrid_trainer_7gpus_multinode', '--grad_cp', '1', '--max_seq_length', '2048', '--dropout', '0.05', '--lr_init', '6e-4', '--lr_final', '1e-5', '--warmup_steps', '1000', '--train_batch_size', '28'), 'state': 'running', 'program': '/home/yueyulin/github/RWKVinLLAMA/train_scripts/train_hybrid_deepspeed.py', 'codePathLocal': 'train_scripts/train_hybrid_deepspeed.py', 'codePath': 'train_scripts/train_hybrid_deepspeed.py', 'git': {'remote': 'https://github.com/yynil/RWKVinLLAMA', 'commit': '1e78af550ebf35fd491a905952cf5b37335044aa'}, 'email': 'yueyu.lin@me.com', 'root': '/home/yueyulin/github/RWKVinLLAMA', 'host': 'server1', 'username': 'yueyulin', 'executable': '/home/yueyulin/miniconda3/envs/new_torch_env/bin/python', 'cpu_count': 8, 'cpu_count_logical': 16, 'cpu_freq': {'current': 2342.4735625, 'min': 1500.0, 'max': 3200.0}, 'cpu_freq_per_core': [{'current': 1500.0, 'min': 1500.0, 'max': 3200.0}, {'current': 1500.0, 'min': 1500.0, 'max': 3200.0}, {'current': 3266.154, 'min': 1500.0, 'max': 3200.0}, {'current': 3397.569, 'min': 1500.0, 'max': 3200.0}, {'current': 1500.0, 'min': 1500.0, 'max': 3200.0}, {'current': 2500.0, 'min': 1500.0, 'max': 3200.0}, {'current': 2500.0, 'min': 1500.0, 'max': 3200.0}, {'current': 2500.0, 'min': 1500.0, 'max': 3200.0}, {'current': 2500.0, 'min': 1500.0, 'max': 3200.0}, {'current': 3400.045, 'min': 1500.0, 'max': 3200.0}, {'current': 3398.775, 'min': 1500.0, 'max': 3200.0}, {'current': 3200.0, 'min': 1500.0, 'max': 3200.0}, {'current': 3397.456, 'min': 1500.0, 'max': 3200.0}, {'current': 1500.0, 'min': 1500.0, 'max': 3200.0}, {'current': 3397.365, 'min': 1500.0, 'max': 3200.0}, {'current': 1500.0, 'min': 1500.0, 'max': 3200.0}], 'disk': {'/': {'total': 3728.65633392334, 'used': 2568.5263900756836}}, 'gpu': 'NVIDIA GeForce RTX 4090', 'gpu_count': 4, 'gpu_devices': [{'name': 'NVIDIA GeForce RTX 4090', 'memory_total': 25757220864}, {'name': 'NVIDIA GeForce RTX 4090', 'memory_total': 25757220864}, {'name': 'NVIDIA GeForce RTX 4090', 'memory_total': 25757220864}, {'name': 'NVIDIA GeForce RTX 4090', 'memory_total': 25757220864}], 'memory': {'total': 251.76150131225586}}
2024-10-26 07:16:00,544 INFO    HandlerThread:2444559 [system_monitor.py:probe():224] Finished collecting system info
2024-10-26 07:16:00,544 INFO    HandlerThread:2444559 [system_monitor.py:probe():227] Publishing system info
2024-10-26 07:16:00,544 DEBUG   HandlerThread:2444559 [system_info.py:_save_conda():209] Saving list of conda packages installed into the current environment
2024-10-26 07:16:00,771 INFO    Thread-12 :2444559 [dir_watcher.py:_on_file_created():271] file/dir created: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/files/conda-environment.yaml
2024-10-26 07:16:03,413 DEBUG   HandlerThread:2444559 [system_info.py:_save_conda():224] Saving conda packages done
2024-10-26 07:16:03,414 INFO    HandlerThread:2444559 [system_monitor.py:probe():229] Finished publishing system info
2024-10-26 07:16:03,416 DEBUG   SenderThread:2444559 [sender.py:send():379] send: files
2024-10-26 07:16:03,416 INFO    SenderThread:2444559 [sender.py:_save_file():1454] saving file wandb-metadata.json with policy now
2024-10-26 07:16:03,561 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: python_packages
2024-10-26 07:16:03,562 DEBUG   SenderThread:2444559 [sender.py:send_request():406] send_request: python_packages
2024-10-26 07:16:03,562 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: stop_status
2024-10-26 07:16:03,563 DEBUG   SenderThread:2444559 [sender.py:send_request():406] send_request: stop_status
2024-10-26 07:16:03,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:03,770 INFO    Thread-12 :2444559 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/files/conda-environment.yaml
2024-10-26 07:16:03,770 INFO    Thread-12 :2444559 [dir_watcher.py:_on_file_created():271] file/dir created: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/files/requirements.txt
2024-10-26 07:16:03,770 INFO    Thread-12 :2444559 [dir_watcher.py:_on_file_created():271] file/dir created: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/files/wandb-metadata.json
2024-10-26 07:16:04,199 DEBUG   SenderThread:2444559 [sender.py:send():379] send: telemetry
2024-10-26 07:16:04,200 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:04,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:04,569 INFO    wandb-upload_0:2444559 [upload_job.py:push():130] Uploaded file /tmp/tmpahpqhk7ewandb/b6iwnwcx-wandb-metadata.json
2024-10-26 07:16:04,771 INFO    Thread-12 :2444559 [dir_watcher.py:_on_file_created():271] file/dir created: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/files/output.log
2024-10-26 07:16:05,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:06,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:06,771 INFO    Thread-12 :2444559 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/files/output.log
2024-10-26 07:16:07,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:08,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:09,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:09,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:10,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:11,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:12,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:13,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:14,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:15,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:15,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:16,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:17,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:18,562 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: stop_status
2024-10-26 07:16:18,562 DEBUG   SenderThread:2444559 [sender.py:send_request():406] send_request: stop_status
2024-10-26 07:16:18,603 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:19,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:20,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:20,820 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:21,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:22,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:23,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:24,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:25,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:26,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:26,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:27,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:28,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:29,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:30,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:31,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:32,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:32,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:33,562 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: stop_status
2024-10-26 07:16:33,562 DEBUG   SenderThread:2444559 [sender.py:send_request():406] send_request: stop_status
2024-10-26 07:16:33,603 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:33,776 INFO    Thread-12 :2444559 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/yueyulin/github/RWKVinLLAMA/wandb/run-20241026_071558-lt709w2v/files/config.yaml
2024-10-26 07:16:34,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:35,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:36,565 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:37,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:37,827 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:38,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:39,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:40,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:41,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:42,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:43,563 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:43,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:44,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:45,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:46,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:47,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:48,562 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: stop_status
2024-10-26 07:16:48,563 DEBUG   SenderThread:2444559 [sender.py:send_request():406] send_request: stop_status
2024-10-26 07:16:48,603 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:48,815 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:49,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:50,566 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:51,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:52,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:53,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:54,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:16:54,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:55,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:56,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:57,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:58,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:16:59,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:00,506 DEBUG   SystemMonitor:2444559 [system_monitor.py:_start():172] Starting system metrics aggregation loop
2024-10-26 07:17:00,507 DEBUG   SenderThread:2444559 [sender.py:send():379] send: stats
2024-10-26 07:17:00,509 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:17:00,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:01,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:02,567 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:03,562 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: stop_status
2024-10-26 07:17:03,563 DEBUG   SenderThread:2444559 [sender.py:send_request():406] send_request: stop_status
2024-10-26 07:17:03,607 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:04,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:05,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:05,785 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:17:06,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:07,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:08,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:09,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:10,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:11,564 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: status_report
2024-10-26 07:17:11,568 DEBUG   HandlerThread:2444559 [handler.py:handle_request():158] handle_request: internal_messages
2024-10-26 07:17:14,529 INFO    cpu       :2444559 [interfaces.py:monitor():138] Process cpu has exited.
2024-10-26 07:17:14,531 DEBUG   SystemMonitor:2444559 [system_monitor.py:_start():179] Finished system metrics aggregation loop
2024-10-26 07:17:14,531 DEBUG   SystemMonitor:2444559 [system_monitor.py:_start():183] Publishing last batch of metrics
2024-10-26 07:17:14,533 DEBUG   SenderThread:2444559 [sender.py:send():379] send: stats
2024-10-26 07:17:15,475 INFO    MainThread:2444559 [internal.py:handle_exit():75] Internal process exited
